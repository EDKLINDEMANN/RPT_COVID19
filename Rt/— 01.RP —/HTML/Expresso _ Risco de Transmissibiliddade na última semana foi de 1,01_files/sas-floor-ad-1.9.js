var sasFloorAd={d:document,w:window,c:window.SmartFloorAdConf,lastClickPixel:0,logOn:!1,addElement:function(t,i,e){var a=this.d.createElement(t);for(var s in e)a.setAttribute(s,e[s]);return i.appendChild(a),a},_addEvent:function(t,i,e){t&&i&&e&&(t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&t.attachEvent("on"+i,e))},flash:function(t,i,e,a){var s="";for(var n in t)s+='<param name="'+n+'" value="'+t[n]+'" />';return'<object type="application/x-shockwave-flash" name="'+i+'" id="'+i+'" width="'+e+'" height="'+a+'" data="'+t.movie+'">'+s+"</object>"},addImage:function(t){var i="";return""!==t.url&&(""!==t.oryginalClickUrl&&(i+='<a href="'+t.clickUrl+'" target="'+("_blank"===t.clickTarget?"_blank":"_self")+'" >'),i+='<img id="img_'+t.id+'" src="'+t.url+'" width="'+t.width+'" height="'+t.height+'" alt="" />',""!==t.oryginalClickUrl&&(i+="</a>")),i},hasFlash:function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},addCss:function(){var t=0,i=0;this.hasFlash()||2!==this.c.creative.type&&3!==this.c.creative.type||!this.c.creative.backup.width?(t=this.staticWidth=this.c.creative.width,i=this.staticHeight=this.c.creative.height):(t=this.staticWidth=this.c.creative.backup.width,i=this.staticHeight=this.c.creative.backup.height);var e=0,a="auto";this.c.expand.collapsedHeight&&("bottom"===this.c.verticalPosition?(a="rect("+(i-this.c.expand.collapsedHeight)+"px, "+t+"px, "+i+"px, 0)",e=-(i-this.c.expand.collapsedHeight)+"px"):a="rect(0, "+t+"px, "+this.c.expand.collapsedHeight+"px, 0)",i=this.c.expand.collapsedHeight);var s="";this.c.expand.enableTransitionEffect&&(s="-moz-transition: all "+this.c.expand.transitionDuration+"s "+this.c.expand.transitionType+";-webkit-transition: all "+this.c.expand.transitionDuration+"s "+this.c.expand.transitionType+";-ms-transition: all "+this.c.expand.transitionDuration+"s "+this.c.expand.transitionType+";-o-transition: all "+this.c.expand.transitionDuration+"s "+this.c.expand.transitionType+"; transition: all "+this.c.expand.transitionDuration+"s "+this.c.expand.transitionType+";");var n="",o="";this.c.background.enableBackground?(n+="width:100%;left:0;",o+="margin:0 "+("right"===this.c.horizontalPosition?"0":"auto")+" 0 "+("left"===this.c.horizontalPosition?"0":"auto")+";"):(n+="width:"+t+"px;","right"===this.c.horizontalPosition?n+="right:0;":"left"===this.c.horizontalPosition?n+="left:0;":n+="left:0;right:0;margin-right:auto;margin-left:auto;text-align:center;");var c=this.d.createElement("style");c.type="text/css";var h=["#sas-fixedDiv_"+this.c.insertionId+"{position:fixed;"+n+"height:"+i+"px;"+this.c.verticalPosition+":"+(this.c.margin?this.c.margin+"px":0)+";z-index:"+this.c.zIndex+";}","#sas-relContainer_"+this.c.insertionId+"{position:relative;"+o+"width:"+t+"px;height:"+i+"px;z-index:"+this.c.zIndex+"}","#sas-absContainer_"+this.c.insertionId+"{position:absolute;top:"+e+";left:0;width:"+t+"px;z-index:"+this.c.zIndex+";clip:"+a+";"+s+"}","#sas-closeButton_"+this.c.insertionId+"{position:absolute;"+this.c.verticalPosition+":"+(i+2)+"px;"+this.c.close.position+":0;cursor:pointer;font;font-family: Arial,sans-serif; font-size:"+this.c.close.fontSize+"px;z-index:"+(this.c.zIndex+1)+";"+s+"color:#"+this.c.close.color+"}","#sas-mask_"+this.c.insertionId+"{position:absolute;bottom:0;left:0;width:100%;height:"+(this.c.expand.collapsedHeight?this.c.expand.collapsedHeight+"px":"100%")+";z-index:"+(this.c.zIndex-1)+"}","#sas-defaultCloseButton_"+this.c.insertionId+"{z-index:"+(this.c.zIndex+1)+";position:absolute;width:50px;height:50px;top:-23px;"+this.c.close.position+":-23px;-webkit-tap-highlight-color: rgba(0,0,0,0);-webkit-user-select:none;max-width:none;}","#img_"+this.c.creative.id+", #img_"+this.c.creative.backup.id+"{border:0}"].join("\r\n");if(this.c.background.enableBackground){var r="background-repeat:"+this.c.background.repeat+";";this.c.background.color&&(r+="background-color:#"+this.c.background.color+";"),this.c.background.image&&(r+='background-image:url("'+this.c.background.image+'");'),this.c.background.position&&(r+="background-position:"+this.c.background.position+";"),this.c.background.opacity>=0&&(r+="opacity:"+this.c.background.opacity/100+"; filter:alpha(opacity="+this.c.background.opacity+");"),h+="\r\n#sas-mask_"+this.c.insertionId+"{"+r+"}"}c.styleSheet?c.styleSheet.cssText=h:c.appendChild(this.d.createTextNode(h)),this.d.getElementsByTagName("head")[0].appendChild(c)},addCloseButton:function(){this.closeButton=this.addElement("div",this.relContainer,{id:"sas-closeButton_"+this.c.insertionId}),""!==this.c.close.label&&(this.closeButton.innerHTML=this.c.close.label),this.c.close.defaultButton&&this.addElement("img",this.closeButton,{id:"sas-defaultCloseButton_"+this.c.insertionId,src:this.c.mediaPath+"images/close-retina.png"}),this.closeButton.onclick=this.w.pub_ist_hd=function(){sasFloorAd.close()}},close:function(){this.fixedDiv&&this.fixedDiv.parentNode.removeChild(this.fixedDiv),clearTimeout(this.timer)},addCreative:function(){var t,i=this;if(this.fixedDiv=this.addElement("div",this.d.body,{id:"sas-fixedDiv_"+this.c.insertionId}),this.relContainer=this.addElement("div",this.fixedDiv,{id:"sas-relContainer_"+this.c.insertionId}),this.absContainer=this.addElement("div",this.relContainer,{id:"sas-absContainer_"+this.c.insertionId}),this.c.background.enableBackground&&this.addElement("div",this.fixedDiv,{id:"sas-mask_"+this.c.insertionId}),0===this.c.creative.type){var e=(t=this.addElement("iframe",this.absContainer,{src:"about:blank",width:this.c.creative.width,height:this.c.creative.height,frameBorder:"0",scrolling:"no",marginheight:"0",marginwidth:"0"})).contentWindow||t,a=t.contentWindow.document;a.open("text/html","replace"),a.write('<!DOCTYPE html><head></head><body style="padding:0;margin:0">'+this.c.creative.agencyCode+"</body></html>"),a.close(),i.c.isRtb&&(i._addEvent(a,"click",function(){i.logRtbClick()}),i.addReadyFunc("iframeDocReady",i,e,a),i.iframeDocReady(function(){i.log("iframeDocReady"),i.overIframe=!1;var t=a.getElementsByTagName("iframe");if(t.length)for(var e in t){var s=t[e];s.onmouseover=function(){i.overIframe=!0},s.onmouseout=function(){i.overIframe=!1,window.top.focus()},i._addEvent(window.top,"blur",function(){i.overIframe&&i.logRtbClick()})}}))}else if(2===this.c.creative.type)this.absContainer.innerHTML=this.hasFlash()||2!==this.c.creative.type?this.c.creative.code:this.addImage(this.c.creative.backup),this.isFlash?this.absContainer.innerHTML=this.flash({movie:this.c.creative.url,wMode:this.c.creative.wMode,quality:"high",allowScriptAccess:"always",allowFullScreen:"true",flashVars:this.c.creative.flashVars},"sas_flash_"+this.c.id,this.c.creative.width,this.c.creative.height):this.absContainer.innerHTML=this.addImage(this.c.creative.backup);else if(4===this.c.creative.type){this._addEvent(this.w,"message",function(t){t.data&&sasFloorAd.c.creative&&sasFloorAd.c.creative.id===Number(t.data)&&t.source.postMessage(sasFloorAd.c.creative.clickUrl,"*")});var s=this.c.creative.url+(this.c.creative.url.indexOf("?")<0?"?":"&")+"sasfid="+this.c.creative.id;t=this.addElement("iframe",this.absContainer,{src:s,width:this.c.creative.width,height:this.c.creative.height,frameBorder:"0",scrolling:"no",marginheight:"0",marginwidth:"0"})}else this.absContainer.innerHTML=this.addImage(this.c.creative);this.c.expand.collapsedHeight&&(this.absContainer.childNodes[0].onmouseover=function(){sasFloorAd.expand()},this.absContainer.onmouseout=function(){sasFloorAd.collapse()}),this.viewabilityCount(this.absContainer)},addReadyFunc:function(t,i,e,a){!function(){"use strict";var s=[],n=!1,o=!1;function c(){if(!n){n=!0;for(var t=0;t<s.length;t++)s[t].fn.call(e,s[t].ctx);s=[]}}function h(){"complete"===a.readyState&&c()}i[t]=function(t,i){n?setTimeout(function(){t(i)},1):(s.push({fn:t,ctx:i}),"complete"===a.readyState||!a.attachEvent&&"interactive"===a.readyState?setTimeout(c,1):o||(a.addEventListener?(a.addEventListener("DOMContentLoaded",c,!1),e.addEventListener("load",c,!1)):(a.attachEvent("onreadystatechange",h),e.attachEvent("onload",c)),o=!0))}}()},expand:function(){this.absContainer.style.clip="rect(0 "+this.staticWidth+"px "+this.staticHeight+"px 0)","top"===this.c.verticalPosition?this.closeButton.style.top=this.staticHeight+2+"px":this.closeButton.style.bottom=this.staticHeight+2+"px"},collapse:function(){"bottom"===this.c.verticalPosition?(this.absContainer.style.clip="rect("+(this.staticHeight-this.c.expand.collapsedHeight)+"px, "+this.staticWidth+"px, "+this.staticHeight+"px, 0)",this.closeButton.style.bottom=this.c.expand.collapsedHeight+2+"px"):(this.absContainer.style.clip="rect(0, "+this.staticWidth+"px, "+this.c.expand.collapsedHeight+"px, 0)",this.closeButton.style.top=this.c.expand.collapsedHeight+2+"px")},logRtbClick:function(){var t=(new Date).getTime();t-this.lastClickPixel>100&&(this.log("rtb click logged"),(new Image).src=this.c.creative.clickCountPixelUrl+"&rnd="+(new Date).getTime(),this.lastClickPixel=t)},log:function(){this.logOn&&console.log(arguments)},tracking:function(t){(new Image).src=t},viewabilityCount:function(t){var i={};i[this.c.creative.id]={viewable:[this.c.viewability.viewUrl],notviewable:[],undetermined:[this.c.viewability.errorUrl]},sas.utils.loadScriptCdn("diff/templates/ts/dist/viewability/sas-viewability-1.0.js",{onLoad:function(){(new window.Viewability).init(t,i,{})}})},init:function(){"undefined"!=typeof inDapIF&&window.inDapIF&&(this.d=window.parent.document,this.w=window.parent),this.isFlash=this.hasFlash(),this.addReadyFunc("docReady",this,this.w,this.d);var t=this;t.docReady(function(){t.addCss(),t.addCreative(),(""!==t.c.close.label||t.c.close.defaultButton)&&t.addCloseButton(),t.c.duration&&(t.timer=setTimeout(function(){sasFloorAd.close()},1e3*t.c.duration)),t.c.trackingUrl&&t.tracking(t.c.trackingUrl)})}};sasFloorAd.init();