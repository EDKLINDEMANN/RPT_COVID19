!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=17)}({0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;this.d=document,this.w=window,this.logOn=!1,this.isReady=!1,this.friendlyIframe=null;var e=this.getIeVersion(navigator.userAgent);if((!!e||window.frameElement)&&void 0!==window.inDapIF&&window.inDapIF){this.log("FIF mode");var i=this.getTopWindow();this.w=i.currentWindow,this.d=this.w.document,this.friendlyIframe=i.currentFrame}this.docReady(function(){return t.isReady=!0})}return t.prototype.addElement=function(t,e,i){var n=this.d.createElement(t);for(var r in i)i.hasOwnProperty(r)&&n.setAttribute(r,i[r]);return e.appendChild(n),n},t.prototype.addEvent=function(t,e,i){t&&e&&i&&(t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.logOn&&console.log(arguments)},t.prototype.docReady=function(t,e,i){var n=this;void 0===e&&(e=this.w),void 0===i&&(i=this.d);var r=function(){n.log("ready"),i.removeEventListener("DOMContentLoaded",r,!1),e.removeEventListener("load",r,!1),t()};"complete"===i.readyState?setTimeout(t):(i.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",r,!1))},t.prototype.winReady=function(t,e,i){var n=this;void 0===e&&(e=this.w),void 0===i&&(i=this.d);var r=function(){n.log("window loaded"),e.removeEventListener("load",r,!1),t()};e.addEventListener("load",r,!1)},t.prototype.tracking=function(t){if(t){(new Image).src=t}},t.prototype.isChild=function(t,e){if(e)for(var i=e.parentNode;null!=i;){if(i===t)return!0;i=i.parentNode}return!1},t.prototype.getElementVisibility=function(t){var e=t.getBoundingClientRect(),i=(e.right-e.left)*(e.bottom-e.top);if(0===i)return 0;var n=Math.max(0,Math.min(e.bottom,this.w.innerHeight)-Math.max(0,e.top)),r=Math.max(0,Math.min(e.right,this.w.innerWidth)-Math.max(0,e.left));return Math.round(n*r*100/i)},t.prototype.checkTabVisibility=function(t,e){var i=this,n=function(){var t=["webkit","moz","ms","o"];if("hidden"in i.d)return"hidden";for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r+"Hidden"in document)return r+"Hidden"}return null},r=function(){var t=n();return!!t&&i.d[t]},a=n();if(a){var s=a.replace(/[H|h]idden/,"")+"visibilitychange";this.addEvent(this.d,s,function(){r()?e():t()})}},t.prototype.getIosVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||"0",10)]}},t.prototype.isExternal=function(t,e){var i=this.getDomain(e);return-1===t.indexOf(i)},t.prototype.getDomain=function(t){var e=t;if(null!=t){var i=t.split(".").reverse();null!=i&&i.length>1&&(e=i[1]+"."+i[0])}return e},t.prototype.offsetTop=function(t){var e=0;do{isNaN(t.offsetTop)||(e+=t.offsetTop),t=t.offsetParent}while(t);return e},t.prototype.getPageHeight=function(){var t=this.d.body,e=this.d.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)},t.prototype.getIeVersion=function(t){t=t||navigator.userAgent;var e=/\b(MSIE |Trident.*?rv:|Edge\/)(\d+)/.exec(t);return e?parseInt(e[2],10):void 0},t.prototype.getTopWindow=function(){for(var t=5,e=window,i=this.getIeVersion(navigator.userAgent)?null:window.frameElement;t--;)try{e.parent&&e.parent.document&&(i=e.frameElement,(e=e.parent)===e.parent&&(t=0))}catch(t){this.log("getTopWindow error",t)}return{currentWindow:e,currentFrame:i}},t.prototype.isMobile=function(){return"ontouchstart"in this.w},t}();e.Global=n},1:function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=function(t){function e(){var e=t.call(this)||this;return e.counterId=0,e.hasFocus=!0,e.isSafeFrame=!1,e.integration=0,e.timeCounter=0,e.resultLayer=null,e.playingCreativeId=-1,e.pixels={},e.threshold=[],e.addEvent(e.w,"focus",function(){return e.hasFocus=!0}),e.addEvent(e.w,"blur",function(){return e.hasFocus=!1}),e}return n(e,t),e.prototype.videoHandler=function(t,e){var i=["start","AdStarted","AdPlaying","resume","play","playing"],n=["complete","skip","AdSkipped","AdStopped"];n.concat(["pause","AdPaused","abort","emptied","ended","error","seeked","seeking"]).indexOf(t)>-1?this.playingCreativeId=-1:i.indexOf(t)>-1&&(this.playingCreativeId=e),n.indexOf(t)>-1&&this.executePixels(e,"notviewable")},e.prototype.updateCreativePixels=function(t,e){return this.log("updateCreativePixels"),this.pixels[t]=e},e.prototype.init=function(t,e,i){var n=this;this.log("init");var r=this.checkElementStatus(t),a=r.measurable;t=r.element,this.pixels=e;var s=this.mergeOptions(i,t);if(s.videoIntegration||(this.playingCreativeId=Object.keys(e)[0]?Number(Object.keys(e)[0]):1),this.integration=s.videoIntegration,s.logMessages&&(this.logOn=!0),s.testLayer&&(this.resultLayer=this.addInfoLayer(t)),i&&i.threshold){this.threshold=i.threshold;this.threshold.forEach(function(t,e){t.lastSent=0,"function"!=typeof t.aboveCallback&&(t.aboveCallback=function(){return console.log()}),"function"!=typeof t.belowCallback&&(t.belowCallback=function(){return console.log()})})}t.id||(t.id="sas_"+(new Date).getTime()+"rnd"),this.overlapStepX=Math.floor(.01*t.offsetWidth)||3,this.overlapStepY=Math.floor(.01*t.offsetHeight)||3,this.counterId=this.w.setInterval(function(){return n.checkElement(t,s,a)},100),window.addEventListener("beforeunload",function(){n.executePixels(n.playingCreativeId,"notviewable")})},e.prototype.checkElement=function(t,e,i){if(this.log("checkElement",t,e),!this.d.getElementById(t.id))return window.clearInterval(this.counterId),void this.log("backup exit - in the meantime someone could remove / close the ad",t);i||this.executePixels(this.playingCreativeId,"undetermined");var n=this.isSafeFrame?Math.round(this.w.$sf.ext.inViewPercentage()):this.getVisibilityPercent(t,e);this.log("Element visibility "+n+"%"),this.playingCreativeId>-1&&this.hasFocus&&n>=e.area?++this.timeCounter>=10*e.delay&&(this.log("Element visible more than "+e.area+"% for "+Math.round(this.timeCounter/10)+" seconds"),this.executePixels(this.playingCreativeId,"viewable"),this.executeViewCallback(e),e.testLayer&&(this.resultLayer.innerHTML="&#10004;")):this.timeCounter=0,this.checkThreshold(n)},e.prototype.executeViewCallback=function(t){t.viewCallback&&(t.viewCallback(),t.viewCallback=null,this.log("View callback function called"))},e.prototype.checkElementStatus=function(t){var e={measurable:!0,element:t};if(!t||window.self===window.top)return this.log("No iframe detected"),e;this.log("Iframe detected");var i=this.getTopWindow();return this.w=i.currentWindow,this.d=this.w.document,e.element=i.currentFrame,i.currentWindow.$sf&&i.currentWindow.$sf.ext?(this.log("SafeFrame detected"),e.element=e.element||t,this.isSafeFrame=!0):void 0!==window.inDapIF&&window.inDapIF?(this.log("Friendly iframe detected"),e.element=t):i.currentWindow===window.top?this.log("Secured iframe detected"):(this.log("Cross-domain iframe detected"),e.element=t,e.measurable=!1),e},e.prototype.area=function(t){var e=t.getBoundingClientRect();return(e.right-e.left)*(e.bottom-e.top)},e.prototype.addInfoLayer=function(t){var e=this.addElement("div",document.body,{id:"testLayer_"+Math.round(1e5*Math.random()),style:"width:60px;height:30px;position:fixed;top:0;right:0;background-color:yellow;\n\t\t\tcolor:blue;font-size:20px;text-align:center;padding-top:5px;z-index:99999;"});return e.innerHTML="0%",e},e.prototype.checkThreshold=function(t){for(var e=0,i=this.threshold;e<i.length;e++){var n=i[e];n.area>t&&n.lastSent<=0?(n.belowCallback(),n.lastSent=1):n.area<=t&&n.lastSent>=0&&(n.aboveCallback(),n.lastSent=-1)}},e.prototype.mergeOptions=function(t,e){var i={area:t&&t.area?t.area:50,testLayer:!(!t||!t.testLayer)&&t.testLayer,logMessages:!(!t||!t.logMessages)&&t.logMessages,videoIntegration:t&&t.videoIntegration?t.videoIntegration:0,threshold:t&&t.threshold?t.threshold:[],viewCallback:t&&t.viewCallback?t.viewCallback:null};return t&&t.delay?i.delay=t.delay:i.delay=i.videoIntegration?2:1,!this.isMobile()&&0===i.videoIntegration&&e.clientHeight*e.clientWidth>242500&&(i.area=30),i},e.prototype.executePixels=function(t,e){var i=!1;if(this.pixels[t]&&this.pixels[t][e]){for(var n=0,r=this.pixels[t][e];n<r.length;n++){var a=r[n];this.tracking(a)}i=!0,delete this.pixels[t],this.playingCreativeId=-1,this.integration<2&&this.w.clearInterval(this.counterId)}return i},e.prototype.isOverlapped=function(t,e,i){for(var n=t.getBoundingClientRect(),r=Math.floor(Math.max(0,n.top)),a=Math.floor(Math.min(n.bottom,this.w.innerHeight)),s=Math.floor(Math.max(0,n.left)),o=Math.floor(Math.min(n.right,this.w.innerWidth)),l=0,h=0,d=null,c=s;c<=o;c+=this.overlapStepX)for(var p=r;p<=a;p+=this.overlapStepY)Math.floor(1e3*Math.random())%250||(d=t.ownerDocument.elementFromPoint(c,p),d===t||this.isChild(t,d)||h++,l++);return!((100-h/l*100)*i/100>e.area)},e.prototype.getVisibilityPercent=function(t,e){var i=this.area(t);if(0===i)return 0;var n=t.getBoundingClientRect(),r=Math.max(0,Math.min(n.bottom,this.w.innerHeight)-Math.max(0,n.top)),a=Math.max(0,Math.min(n.right,this.w.innerWidth)-Math.max(0,n.left)),s=Math.round(r*a*100/i);return e.testLayer&&(n.top<0?(this.resultLayer.style.top="auto",this.resultLayer.style.bottom="0px"):(this.resultLayer.style.top="0px",this.resultLayer.style.bottom="auto"),this.resultLayer.innerHTML=s+"%"),s},e}(r.Global);e.Viewability=a,window.Viewability=a},17:function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=function(t){function e(e){var i=t.call(this,e)||this;return i.c=e,i.adPlacement=null,i.creativeRatio=1.78,i.container=null,i.videoDiv=null,i.relDiv=null,i.relDivPlayer=null,i.advDiv=null,i.bannerDiv=null,i.bannerLabel=null,i.bannerHolderDiv=null,i.animationTime=.7,i.obj=null,i.wasVisible=!1,i.minimized=!1,i.expandWidth=0,i.expandHeight=0,i.playerInitiated=!1,i.playerLayerStarted=!1,i.playing=!1,i}return n(e,t),e.prototype.addMyCss=function(){this.log("addMyCss"),this.prepareParams(),this.c.banner.scalable&&this.c.banner.url&&this.calculateBannerDimension();var t=this.c.other.animation?this.createMultiBrowserCss("transition:all "+String(this.animationTime)+"s ease"):"";return"\n\t\t\t#sas_container_"+this.c.insertionId+"{\n\t\t\t\tclear:both;\n\t\t\t\theight:auto;\n\t\t\t\tposition: relative;\n\t\t\t\tmargin:0px auto 5px;\n\t\t\t\tmin-height:1px;\n\t\t\t\twidth:"+this.c.creative.width+"px;\n\t\t\t\t"+t+"\n\t\t\t}\n\t\t\t#sas_container_"+this.c.insertionId+".mini_player div.sas-linear .sas-ctrl-panel{\n\t\t\t\tdisplay: none !important;\n\t\t\t}\n\t\t\t#sas_container_"+this.c.insertionId+".mini_player div.sas-linear{\n\t\t\t\tbackground: none !important;\n\t\t\t}\n\t\t\t#sas_container_"+this.c.insertionId+".mini_player div.sas-stacked{\n\t\t\t\toverflow: inherit\n\t\t\t}\n\t\t\t#sas_videoDiv_"+this.c.insertionId+"{\n\t\t\t\tposition:relative;\n\t\t\t\tz-index:"+this.c.other.zIndex+";\n\t\t\t\theight:0;\n\t\t\t\t"+t+"\n\t\t\t}\n\t\t\t#sas_relDiv_"+this.c.insertionId+"{\n\t\t\t\topacity:1;\n\t\t\t\tmargin:0 auto 0 0;\n\t\t\t\ttop:0;\n\t\t\t\tbottom:0;\n\t\t\t\twidth: "+this.c.creative.width+"px;\n\t\t\t\theight:0;\n\t\t\t\tposition:absolute;\n\t\t\t\t"+t+"\n\t\t\t}\n\t\t\t#sas_relDiv_"+this.c.insertionId+" img{\n\t\t\t\tborder:0\n\t\t\t}\n\t\t\t#sas_relDivPlayer_"+this.c.insertionId+"{\n\t\t\t\tborder:0;\n\t\t\t\tposition:absolute;\n\t\t\t\twidth: 100%;\n\t\t\t\theight:100%;\n\t\t\t\ttop:0;\n\t\t\t\tbottom:0;\n\t\t\t\toverflow:hidden;\n\t\t\t\tz-index:1;\n\t\t\t\t"+t+"\n\t\t\t}\n\t\t\t#sas_advDiv_"+this.c.insertionId+"{\n\t\t\t\tmargin:0px;\n\t\t\t\tdisplay:none;\n\t\t\t\tposition:relative;\n\t\t\t\ttext-align:center;\n\t\t\t\tfont-family: Arial,sans-serif;\n\t\t\t\tfont-size:"+this.c.textLabel.fontSize+"px;\n\t\t\t\tclear:both;\n\t\t\t\tcolor:#"+this.c.textLabel.color+"\n\t\t\t}\n\t\t\t#sas_relDiv_"+this.c.insertionId+" div.sas-linear div a,\n\t\t\t#sas_relDiv_"+this.c.insertionId+" div.sas-linear div {\n\t\t\t\tcolor:#"+this.c.player.buttons.color+"\n\t\t\t}\n\t\t\t#sas_relDiv_"+this.c.insertionId+" div.sas-linear .sas-ctrl-panel, \n\t\t\t#sas_relDiv_"+this.c.insertionId+" div.sas-linear .sas-ctrl-skipcountdown, \n\t\t\t#sas_relDiv_"+this.c.insertionId+" div.sas-linear .sas-btn-skip{\n\t\t\t\tbackground-color: rgba(0, 0, 0, "+this.c.player.bar.barOpacity+");\n\t\t\t}\n\t\t\t#sas_bannerDiv_"+this.c.insertionId+"{\n\t\t\t\tmargin:0 auto;\n\t\t\t\tposition:relative;\n\t\t\t}\n\t\t\t#sas_bannerDiv_"+this.c.insertionId+" #sas_bannerHolderDiv_"+this.c.insertionId+"{\n\t\t\t\theight:0px;\n\t\t\t\t"+t+"\n\t\t\t}\n\t\t\t#sas_bannerDiv_"+this.c.insertionId+" img{\n\t\t\t\tdisplay: block;\n\t\t\t\twidth:"+this.c.banner.width+"px;\n\t\t\t\theight:"+this.c.banner.height+"px;\n\t\t\t\tmargin:0 auto;\n\t\t\t}\n\t\t\t#sas_bannerLabel_"+this.c.insertionId+"{\n\t\t\t\tposition:absolute;\n\t\t\t\tcursor:pointer;\n\t\t\t\tdisplay:block;\n\t\t\t\tz-index:"+this.c.other.zIndex+";\n\t\t\t\tcolor:#"+this.c.banner.replayColor+";\n\t\t\t\tfont-family:Arial,sans-serif;\n\t\t\t\tfont-size:13px;\n\t\t\t}\n\t\t\t#sas_bannerLabel_"+this.c.insertionId+".sas_bannerLabel_right-bottom{\n\t\t\t\tbottom:0;\n\t\t\t\tright:0;\n\t\t\t\tpadding:0 6px 6px 0;\n\t\t\t}\n\t\t\t#sas_bannerLabel_"+this.c.insertionId+".sas_bannerLabel_right-top{\n\t\t\t\tbottom:0;\n\t\t\t\tright:0;\n\t\t\t\tpadding:6px 6px 0 0;\n\t\t\t}\n\t\t\t#sas_bannerLabel_"+this.c.insertionId+".sas_bannerLabel_left-bottom{\n\t\t\t\tbottom:0;\n\t\t\t\tleft:0;\n\t\t\t\tpadding:0 0 6px 6px;\n\t\t\t}\n\t\t\t#sas_bannerLabel_"+this.c.insertionId+".sas_bannerLabel_left-top{\n\t\t\t\ttop:0;\n\t\t\t\tleft:0;\n\t\t\t\tpadding:0 6px 6px 0;\n\t\t\t}\n\t\t\t#sas_backupCloseButton_"+this.c.insertionId+" {\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: -5px;\n\t\t\t\tright: -5px;\n\t\t\t\tz-index: "+(this.c.other.zIndex+1)+";\n\t\t\t\twidth: 50px;\n\t\t\t\theight: 50px;\n\t\t\t\t-webkit-tap-highlight-color: rgba(0,0,0,0);\n\t\t\t\t-webkit-user-select: none;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t\t#sas_relDivPlayer_"+this.c.insertionId+".sas-fullscreen + #sas_backupCloseButton_"+this.c.insertionId+"{\n\t\t\t\tz-index: 2147483648\n\t\t\t}\n\t\t"},e.prototype.prepareParams=function(){this.log("prepareParams"),this.c.creative.width=this.c.creative.width?this.c.creative.width:this.obj.width,this.c.creative.height=this.c.creative.height?this.c.creative.height:this.obj.height;var t=this.calculateDimensions(this.c.creative.width,this.c.creative.height,this.container,this.c.maxWidth);this.c.creative.width=this.c.creative.backup.width=t.width,this.c.creative.height=this.c.creative.backup.height=t.height},e.prototype.renderAd=function(){var t;if(this.log("renderAd"),this.d.getElementById("sas_previewContainer")&&(this.log("preview mode"),this.buildTestContent(this.c.adPosition)),this.adPlacement=this.getAdPlacement(this.c.adPosition),!this.adPlacement)return void this.log("no placement found");this.c.creative.width&&this.c.creative.height&&(this.creativeRatio=Math.round(this.c.creative.width/this.c.creative.height*100)/100),this.log("creativeRatio: "+this.creativeRatio),this.container=this.addElement("div",this.adPlacement,{id:"sas_container_"+this.c.insertionId}),this.c.textLabel.text&&(this.advDiv=this.addElement("span",this.container,{id:"sas_advDiv_"+this.c.insertionId}),this.advDiv.innerHTML=this.c.textLabel.text),this.addCss(this.addMyCss()),this.c.banner.url&&this.renderBanner(),this.c.banner.showFirstlyBanner&&this.c.banner.url||this.playerPositionListener(),this.pageListeners();var e=Math.round(1e5*Math.random());this.viewability.init(this.container,(t={},t[this.c.creative.id]={viewable:[this.prepareTrackingUrl("viewcount",e)],undetermined:[this.prepareTrackingUrl("viewUndetermined",e)]},t),{videoIntegration:this.c.banner.url&&this.c.banner.showFirstlyBanner?0:1,threshold:[{area:this.c.other.playWhenVisible}]})},e.prototype.playerPositionListener=function(){var t=this;this.checkPlayerVisibility(),this.addEvent(this.w,"scroll",function(){t.firstPlay&&t.checkPlayerVisibility()})},e.prototype.renderPlayer=function(){var t=this;this.log("player render",this.obj),this.dataLoaded&&(this.videoDiv=this.addElement("div",this.container,{id:"sas_videoDiv_"+this.c.insertionId}),this.relDiv=this.addElement("div",this.videoDiv,{id:"sas_relDiv_"+this.c.insertionId}),this.relDivPlayer=this.addElement("div",this.relDiv,{id:"sas_relDivPlayer_"+this.c.insertionId}),this.c.player.buttons.forcedCloseButton=this.c.player.buttons.forcedCloseButton&&("application/javascript"===this.contentType||"application/x-javascript"===this.contentType),this.c.player.buttons.skip=!this.c.player.buttons.forcedCloseButton,"application/javascript"!==this.contentType&&"application/x-javascript"!==this.contentType||(this.c.player.enableCtrlSkipCountDown=!1),this.c.banner.showFirstlyBanner&&this.c.banner.url&&(this.countImpression=!0),!this.playerInitiated&&this.obj&&this.obj.url&&this.addPlayer(this.c.player,this.relDivPlayer,this.obj,function(e){"exitFullscreen"===e&&(t.fullScreenFlag=!1),t.c.banner.url&&t.c.banner.showFirstlyBanner&&"error"===e&&(t.countImpression=!1),t.c.banner.url&&t.c.banner.showFirstlyBanner&&"start"===e&&(t.countImpression=!0)},function(){t.onStart()},function(){t.onEnd()},this.animationTime,!1),this.playerInitiated=!0)},e.prototype.calculateBannerDimension=function(){this.log("banner dimension"+this.c.banner.width+"x"+this.c.banner.height);var t=1.78;this.c.banner.width&&this.c.banner.height&&(t=Math.round(this.c.banner.width/this.c.banner.height*100)/100),this.c.banner.width=this.c.creative.width,this.c.banner.height=Math.round(this.c.banner.width/t)},e.prototype.renderBanner=function(){this.log("renderBanner"),this.bannerDiv=this.addElement("div",this.container,{id:"sas_bannerDiv_"+this.c.insertionId}),this.bannerHolderDiv=this.addElement("div",this.bannerDiv,{id:"sas_bannerHolderDiv_"+this.c.insertionId}),this.bannerHolderDiv.innerHTML=this.addImage(this.c.banner),this.c.banner.replayText&&this.renderBannerLabel(),this.bannerHolderDiv.style.height=this.c.banner.height+"px",this.c.banner.showFirstlyBanner&&this.bannerPositionListener()},e.prototype.bannerPositionListener=function(){var t=this;this.addEvent(this.w,"scroll",function(){t.checkBannerVisibility()}),this.addEvent(this.w,"touchmove",function(){t.checkBannerVisibility()}),this.checkBannerVisibility()},e.prototype.pageListeners=function(){var t=this;this.addEvent(this.w,"resize",function(){t.closed&&!t.c.banner.url||t.orientationChange()})},e.prototype.orientationChange=function(){var t=this;this.videoDiv&&(this.videoDiv.style.width="",this.relDiv.style.width=""),this.container.style.width="",this.container.style.height="",this.addCss(this.addMyCss()),this.videoDiv&&this.playing&&(this.relDiv.style.height=this.c.creative.height+"px",this.videoDiv.style.height=this.c.creative.height+"px"),this.bannerHolderDiv&&(this.bannerHolderDiv.style.height=this.c.banner.height+"px"),this.w.setTimeout(function(){t.minimized&&t.miniPlayer()},500)},e.prototype.checkPlayerVisibility=function(){if(!this.playerLayerStarted){var t=this.d.body.scrollTop||this.d.documentElement.scrollTop||this.w.pageYOffset;(0===this.c.other.playWhenVisible||t+this.w.innerHeight>this.c.other.playWhenVisible/100*this.c.creative.height+this.offsetTop(this.container)&&t<this.offsetTop(this.container)+this.c.other.playWhenVisible/100*this.c.creative.height)&&(this.renderPlayer(),this.playerLayerStarted=!0)}},e.prototype.checkBannerVisibility=function(){this.getElementVisibility(this.bannerDiv)>this.c.other.playWhenVisible&&(this.countImpression||this.countImpressionFunc())},e.prototype.renderBannerLabel=function(){var t=this;this.log("renderBannerLabel"),this.bannerLabel||(this.bannerLabel=this.addElement("div",this.bannerDiv,{id:"sas_bannerLabel_"+this.c.insertionId,class:"sas_bannerLabel_"+this.c.banner.replayPos}),this.c.banner.showFirstlyBanner||(this.bannerLabel.style.display="none"),this.bannerLabel.innerHTML=this.c.banner.replayText,this.addEvent(this.bannerLabel,"click",function(){t.bannerLabel.style.display="none",t.playerInitiated=!1,t.firstPlay=!0,t.renderPlayer()}))},e.prototype.onStart=function(){var t=this;this.log("onStart"),this.closed=!1,this.playing=!0,this.advDiv&&(this.advDiv.style.display="block"),this.videoDiv.style.height=this.c.creative.height+"px",this.relDiv.style.height=this.c.creative.height+"px",this.relDiv.style.width=this.c.creative.width+"px",this.w.setTimeout(function(){t.addListeners()},1e3*this.animationTime)},e.prototype.onEnd=function(){var t=this;this.log("onEnd"),this.closed=!0,this.playerDestroyed=!0,this.playing=!1,this.w.setTimeout(function(){return t.videoDiv.parentNode.removeChild(t.videoDiv)},1e3*this.animationTime),this.c.banner.url?this.c.banner.replayText&&(this.bannerLabel.style.display="block",this.relDiv.style.height="0px",this.relDivPlayer.style.height="0px",this.container.style.height="auto",this.container.className=""):(this.relDiv.style.height="0px",this.relDivPlayer.style.height="0px",this.w.setTimeout(function(){return t.container.parentNode.removeChild(t.container)},1e3*this.animationTime)),this.c.miniPlayer.miniPlayerEnable&&this.minimized&&this.w.setTimeout(function(){t.resetMiniPlayer()},1e3*this.animationTime)},e.prototype.addListeners=function(){var t=this;if(this.log("addListeners"),this.c.player.onMouseOutMute&&(this.onMouseOverUnMute(this.relDiv,this.player),this.onMouseOutMute(this.relDiv,this.player)),this.c.player.buttons.fullscreenButton){var e=this.videoDiv.getElementsByClassName("sas-btn-fullscreen")[0];this.addEvent(e,"click",function(){t.fullScreenFlag=!t.fullScreenFlag})}if(this.addEvent(this.w,"scroll",function(){t.checkPosition()}),this.addEvent(this.w,"touchmove",function(){t.checkPosition()}),this.checkPosition(),this.c.player.pauseTab&&this.pauseOnTabChange(this.player,this.contentType),this.c.expand.expandEnable){var i=this.expandDimensionSize(this.c.expand.width,this.c.expand.height);this.expandWidth=i.width,this.expandHeight=i.height,this.addEvent(this.videoDiv,"mouseenter",function(){t.fullScreenFlag||(t.expand(),t.player.resize(t.c.creative.width,t.c.creative.height,"NORMAL"))}),this.addEvent(this.videoDiv,"mouseleave",function(){t.fullScreenFlag||(t.collapse(),t.player.resize(t.c.creative.width,t.c.creative.height,"NORMAL"))})}},e.prototype.expandDimensionSize=function(t,e){var i,n;return i=-1!==t.indexOf("%")?Math.round(Number(t.replace("%",""))/100*this.c.creative.width):Number(this.c.expand.width.replace("px","")),n=-1!==e.indexOf("%")?Math.round(Number(e.replace("%",""))/100*this.c.creative.height):Number(this.c.expand.height.replace("px","")),this.log("expand dimension size "+i+"x"+n),{height:n,width:i}},e.prototype.expand=function(){var t=Math.round(1e5*Math.random());if(this.log("expand player"),!this.closed){switch(this.c.expand.direction){case"top right":this.relDivPlayer.style.bottom="0",this.relDivPlayer.style.left="0",this.relDivPlayer.style.right="auto",this.relDivPlayer.style.top="auto";break;case"top left":this.relDivPlayer.style.bottom="0",this.relDivPlayer.style.right="0",this.relDivPlayer.style.left="auto",this.relDivPlayer.style.top="auto";break;case"bottom right":this.relDivPlayer.style.top="0",this.relDivPlayer.style.left="0",this.relDivPlayer.style.right="auto",this.relDivPlayer.style.bottom="auto";break;case"bottom left":this.relDivPlayer.style.top="0px",this.relDivPlayer.style.right="0px",this.relDivPlayer.style.left="auto",this.relDivPlayer.style.bottom="auto"}this.relDivPlayer.style.width=this.expandWidth+"px",this.relDivPlayer.style.height=this.expandHeight+"px",this.tracking(this.prepareTrackingUrl("AdExpand",t)),this.c.expand.trackingUrlExpand&&this.tracking(this.c.expand.trackingUrlExpand)}},e.prototype.collapse=function(){this.log("collapse player");var t=Math.round(1e5*Math.random());this.closed||(this.relDivPlayer.style.width="100%",this.relDivPlayer.style.height="100%",this.c.expand.trackingUrlCollapse&&this.tracking(this.c.expand.trackingUrlCollapse),this.tracking(this.prepareTrackingUrl("AdCollapse",t)))},e.prototype.checkPosition=function(){if(!this.closed){var t=this.getElementVisibility(this.container);this.log("visibility-> "+t),this.c.miniPlayer.miniPlayerEnable&&(t<51&&this.wasVisible?this.minimized||this.fullScreenFlag||this.miniPlayer():this.minimized&&!this.fullScreenFlag&&this.resetMiniPlayer(),t>50&&(this.log("player was visible"),this.wasVisible=!0)),t>=this.c.other.playWhenVisible&&this.player?(this.log("visible"),this.player.play(),this.paused=!1):t<this.c.other.playWhenVisible&&!this.c.miniPlayer.miniPlayerEnable&&this.player&&!this.fullScreenFlag&&(this.player.pause(),this.paused=!0)}},e.prototype.resetMiniPlayer=function(){this.log("mini player reset"),this.minimized=!1,this.relDiv.style.marginLeft="0",this.relDiv.style.marginTop="0",this.relDiv.style.marginBottom="0",this.relDiv.style.left="",this.relDiv.style.right="","top-left"===this.c.miniPlayer.direction||"top-right"===this.c.miniPlayer.direction?this.relDiv.style.top="inherit":this.relDiv.style.top="0",this.relDiv.style.bottom="",this.container.className="",this.relDiv.style.position="absolute",this.bannerDiv&&(this.bannerDiv.style.display="block"),this.closed?this.relDiv.style.height="0px":(this.relDiv.style.width=this.c.creative.width+"px",this.relDiv.style.height=this.c.creative.height+"px",this.player.resize(this.c.creative.width,this.c.creative.height,"NORMAL"))},e.prototype.miniPlayer=function(){this.log("mini player mode"),this.minimized=!0;var t=-1!==this.c.miniPlayer.miniPlayerSize.indexOf("%")?Math.round(this.c.miniPlayer.miniPlayerSize.replace("%","")/100*this.c.creative.width):this.c.miniPlayer.miniPlayerSize.replace("px",""),e=Math.round(t/this.creativeRatio),i=this.container.getBoundingClientRect();switch("mini_player"!==this.container.className&&(this.container.className+="mini_player"),this.relDiv.style.width=t+"px",this.relDiv.style.height=e+"px",this.relDivPlayer.style.width="100%",this.relDivPlayer.style.height="100%",this.relDiv.style.position="fixed",this.relDiv.style.top=i.top+"px",this.relDiv.style.bottom="0",this.relDiv.style.left=i.left+"px",this.relDiv.style.right="0",this.c.miniPlayer.direction){case"left":this.relDiv.style.left="auto",this.relDiv.style.right="auto",i.top<=0?(this.relDiv.style.top="0",this.relDiv.style.marginTop=this.c.miniPlayer.offsetY+"px"):(this.relDiv.style.top="auto",this.relDiv.style.bottom=this.c.miniPlayer.offsetY+"px"),this.relDiv.style.marginLeft=-this.c.miniPlayer.offsetX+"px";break;case"right":this.relDiv.style.right="auto",this.relDiv.style.left="auto",i.top<=0?(this.relDiv.style.top="0",this.relDiv.style.marginTop=this.c.miniPlayer.offsetY+"px"):(this.relDiv.style.top="auto",this.relDiv.style.bottom=this.c.miniPlayer.offsetY+"px"),this.relDiv.style.marginLeft=this.c.miniPlayer.offsetX+"px";break;case"top-left":this.relDiv.style.marginLeft=-(i.left-this.c.miniPlayer.offsetX)+"px",i.top<=0?this.relDiv.style.top=this.c.miniPlayer.offsetY+"px":(this.relDiv.style.top="auto",this.relDiv.style.marginBottom=this.w.innerHeight-e-this.c.miniPlayer.offsetY+"px");break;case"top-right":this.relDiv.style.marginLeft=this.d.body.clientWidth-t-this.c.miniPlayer.offsetX-i.left+"px",i.top<=0?this.relDiv.style.top=this.c.miniPlayer.offsetY+"px":(this.relDiv.style.top="auto",this.relDiv.style.marginBottom=this.w.innerHeight-this.c.miniPlayer.offsetY-e+"px");break;case"bottom-right":this.relDiv.style.marginLeft=this.d.body.clientWidth-t-this.c.miniPlayer.offsetX-i.left+"px",i.top<=0?(this.relDiv.style.top="0",this.relDiv.style.marginTop=this.w.innerHeight-e-this.c.miniPlayer.offsetY+"px"):(this.relDiv.style.top="auto",this.relDiv.style.bottom=this.c.miniPlayer.offsetY+"px");break;case"bottom-left":this.relDiv.style.marginLeft=-(i.left-this.c.miniPlayer.offsetX)+"px",i.top<=0?(this.relDiv.style.top="0",this.relDiv.style.marginTop=this.w.innerHeight-e-this.c.miniPlayer.offsetY+"px"):(this.relDiv.style.top="auto",this.relDiv.style.bottom=this.c.miniPlayer.offsetY+"px")}this.player.resize(Number(t),Number(e),"NORMAL")},e.prototype.init=function(){var t=this;this.log("init");var e=this.getIosVersion();e&&e[0]<10||(this.executeCustomScripts(this.c.customScript,[this.c.creative],this.c.isAsync,this.c.tagId),null!=this.c.creative&&(this.c.other.animation||(this.animationTime=0),this.docReady(function(){t.getCreative(function(e){t.dataLoaded&&(t.obj=e,t.renderAd())})})))},e}(r.SasVideo);e.VideoRead=a,window.VideoRead=a},2:function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=i(1),s=(window.sas,function(t){function e(e){var i=t.call(this)||this;return i.c=e,i.isFlash=!1,i.closed=!1,i.iCustomScriptExecuted=!1,i.animationSpeed={none:0,slow:2,medium:1.4,fast:.7},i.buttonSize={small:1,normal:1.5,big:2},i.lastClicked=0,i.overIframe=!1,document.getElementById(e.tagId)||document.write('<div id="'+e.tagId+'"></div>'),i.isFlash=i.hasFlash(),i.c.filePath&&(i.closeButtonUrl=i.c.filePath+"images/close-retina.png",i.closeButtonUrl2=i.c.filePath+"images/close_54x54.png",i.expandButtonUrl=i.c.filePath+"images/expand_54x54.png"),i.viewability=new a.Viewability,i}return n(e,t),e.prototype.calculateDimensions=function(t,e,i,n){var r=1.78;t&&e&&(r=Math.round(t/e*100)/100);var a,s=i.parentElement.clientWidth;-1!==n.indexOf("px!")?a=Number(n.replace("px!","")):(a=-1!==n.indexOf("%")?Math.round(Number(n.replace("%",""))/100*s):Number(n.replace("px","")))>s&&(a=s);var o=Math.round(a/r);return this.log("calculateDimensions, input: "+t+", "+e+", output: "+a+", "+o),{height:o,width:a}},e.prototype.addCss=function(t){var e=this.d.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(this.d.createTextNode(t)),this.d.getElementsByTagName("head")[0].appendChild(e)},e.prototype.whichTransitionEvent=function(){var t=this.d.createElement("fakeelement"),e={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in e)if(void 0!==t.style[i])return e[i]},e.prototype.addImage=function(t){var e="";if(""!==t.url){""!==t.oryginalClickUrl&&(e+='<a href="'+t.clickUrl+'" target="'+("_blank"===t.clickTarget?"_blank":"_self")+'" >');var i=t.alt?t.alt:"";e+='<img\n\t\t\t\tid="img_'+t.id+'"\n\t\t\t\tsrc="'+t.url+'"\n\t\t\t\twidth="'+t.width+'"\n\t\t\t\tborder="0"\n\t\t\t\theight="'+t.height+'"\n\t\t\t\talt="'+i+'" />',""!==t.oryginalClickUrl&&(e+="</a>")}return e},e.prototype.flash=function(t,e,i,n){this.log("flash");var r="";for(var a in t)t.hasOwnProperty(a)&&(r+='<param name="'+a+'" value="'+t[a]+'" />');return'<object type="application/x-shockwave-flash"\n\t\t\t\t\tname="'+e+'"\n\t\t\t\t\tid="'+e+'"\n\t\t\t\t\twidth="'+i+'"\n\t\t\t\t\theight="'+n+'"\n\t\t\t\t\tdata="'+t.movie+'">'+r+"\n\t\t\t\t</object>"},e.prototype.addCreative=function(t,e,i,n,r,a,s,o){var l=this;void 0===i&&(i=!1),void 0===n&&(n=""),void 0===r&&(r=!0),void 0===o&&(o=!1),this.log("addCreative",t,e,i,n,r,a);var h=t.agencyCode;n&&!this.iCustomScriptExecuted&&(h+=n,this.iCustomScriptExecuted=!0);var d=0!==t.width||o?t.width:"100%",c=0!==t.height||o?t.height:"100%",p=this.c.tagId;if(0===t.type){var u=this.addElement("iframe",e,{src:"about:blank",width:d,height:c,frameBorder:"0",allow:"autoplay;fullscreen;",scrolling:"no",marginheight:"0",marginwidth:"0",id:p+"_iframe"}),v=u.contentWindow||u,y=u.contentWindow.document;if(this.getIeVersion(navigator.userAgent))try{y.domain=this.d.domain}catch(t){this.log(t)}y.open("text/html","replace"),y.write("\n\t\t\t\t<!DOCTYPE html>\n\t\t\t\t\t<head><script>var inDapIF = "+i+'<\/script></head>\n\t\t\t\t\t<body style="padding:0;margin:0 auto">\n\t\t\t\t\t\t'+h+"\n\t\t\t\t\t</body>\n\t\t\t\t</html>\n\t\t\t"),y.close(),a&&(this.log("iframe ready"),a(v,y)),s&&this.winReady(function(){l.log("iframe load"),s(v,y,u)},v,y)}else if(4===t.type){var g=0,f=t.url+(t.url.indexOf("?")<0?"?":"&")+"sasfid="+t.id;if(t.clickUrlArray)for(var m=0,b=t.clickUrlArray;m<b.length;m++){var w=b[m];f+="&clicktag"+(g++?g:"")+"="+encodeURIComponent(w)}this.addElement("iframe",e,{src:f,width:d,height:c,frameBorder:"0",allow:"autoplay;fullscreen;",scrolling:"no",marginheight:"0",marginwidth:"0",id:p+"_iframe"}),this.addEvent(this.w,"message",function(e){if(e.data&&t.id===Number(e.data)){var i={clickUrls:t.clickUrlArray,isSmart:!0};e.source.postMessage(JSON.stringify(i),"*")}})}else e.innerHTML=this.addImage(t);if(t.type&&h)if(r||this.isReady){var x=this.addElement("iframe",e,{src:"about:blank",frameBorder:0,allow:"autoplay;fullscreen;",scrolling:"no",marginheight:0,marginwidth:0,style:"width:1px;height:0px;visibility:hidden"}),k=x.contentWindow.document;k.open("text/html","replace"),k.write('\n\t\t\t\t\t<!DOCTYPE html>\n\t\t\t\t\t\t<head></head>\n\t\t\t\t\t\t<body style="padding:0;margin:0 auto">'+h+"</body>\n\t\t\t\t\t</html>\n\t\t\t\t"),k.close()}else document.write(h)},e.prototype.getPlacement=function(t){var e=this.d.getElementById(t);return this.friendlyIframe&&(this.friendlyIframe.setAttribute("style","width:1px; height:1px;position:absolute;"),this.friendlyIframe.setAttribute("allow","autoplay;fullscreen;"),e||(e=this.d.createElement("DIV"),e.setAttribute("id",t),this.friendlyIframe.parentNode.insertBefore(e,this.friendlyIframe))),this.log("adPlacement",e),e},e.prototype.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator&&navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},e.prototype.stopEvent=function(t){return t||(t=window.event),t.cancelBubble=!0,t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},e.prototype.prepareTrackingUrl=function(t,e,i){var n=this.c.statisticTracking;return this.c.baseUrl+"/track/action?sid="+this.c.sessionId+"&pid="+this.c.pageId+"&iid="+this.c.insertionId+"&cid="+this.c.creative.id+"&key="+t+this.validateParam("vit",n.videoIntegrationType)+this.validateParam("vct",n.videoClientTechnology)+this.validateParam("vrn",n.videoRevisionNumber)+(n.rtbbid?"&rtb=1&rtbbid="+n.rtbbid+"&rtbet="+n.rtbet+"&rtblt="+n.rtblt+"&rtbnid="+n.rtbnid+"&rtbh="+n.rtbh:"")+"&"+(i?"num1="+i+"&":"")+"ts="+e},e.prototype.createMultiBrowserCss=function(t){return"-moz-"+t+";-webkit-"+t+";-ms-"+t+";-o-"+t+";"+t+";"},e.prototype.executeCustomScripts=function(t,e,i,n){for(var r=t,a=0,s=e;a<s.length;a++){var o=s[a];0!==o.type&&(r+=o.agencyCode)}if(i){if(r.replace(/\r\n/gm,"")){var l=document.createElement("iframe");l.src="about:blank";var h="width:1px;height:0;visibility:hidden;";l.setAttribute("style",h),l.setAttribute("allow","autoplay;fullscreen;"),l.style.cssText=h,function(t,e){var i=document.getElementById(t);if("string"==typeof e){var n=document.createElement("div");n.innerHTML=e,e=n}i.appendChild(e)}(n,l);var d=l.contentWindow.document;d.open("text/html","replace"),d.write("<!DOCTYPE html><head></head><body>"+r+"</body></html>"),d.close()}}else document.write(r)},e.prototype.findPlaceForAd=function(t){this.log("findPlaceForAd",t);var e,i,n=[],r=this.d.createElement("div");r.id="sas_intextContainer_"+this.c.insertionId,n=t.idNames.split(";"),""===n[n.length-1]&&n.splice(n.length-1,1);for(var a=0,s=n;a<s.length;a++){switch(i=s[a].replace(/^\s+|\s+$/g,""),t.selectedPosition){case"paragraph by id":e=this.d.getElementById(i);break;case"paragraph by class name":e=this.d.getElementsByClassName(i),e.length&&(e=e[0]);break;case"paragraph by item prop":for(var o=this.d.getElementsByTagName("*"),l=0,h=o.length;l<h;l++){var d=o[l];if(d.getAttribute("itemprop")===i){e=d;break}}break;case"specified element by id":e=this.d.getElementById(i);break;case"specified element by class name":e=this.d.getElementsByClassName(i),e.length&&(e=e[0])}if(("specified element by id"===t.selectedPosition||"specified element by class name"===t.selectedPosition)&&e&&e.tagName)return e;if(e&&e.tagName){var c=e.getElementsByTagName(t.paragraphType);if("automatic"===t.positionInParagraph){if(0!==c.length&&c.length<100)for(var p=c.length-1;p>=0;p--){var u=this.getElementVisibility(c[p]);if(this.log("checkElementVisibility for element number "+p,c[p],u),u>0&&u<100||0===p)return c[p].parentNode.insertBefore(r,c[p].nextSibling),r}}else if("specified paragraph"===t.positionInParagraph&&0!==t.paragraphNumber){if(0!==c.length&&c.length<100){for(var v=0;v<=c.length-1;v++)t.paragraphNumber>0&&v===t.paragraphNumber-1?c[v].parentNode.insertBefore(r,c[v].nextSibling):t.paragraphNumber>c.length&&e.appendChild(r);return r}}else{if("bottom"===t.positionInParagraph)return e.appendChild(r),r;if("top"===t.positionInParagraph)return e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r}}}return this.log("show anyway"),this.findPlaceForAdAuto()},e.prototype.getAdPlacement=function(t){var e=null;switch(t.selectedPosition){case"automatic":e=this.findPlaceForAdAuto();break;case"ad placement":e=this.getPlacement(this.c.tagId);break;default:e=this.findPlaceForAd(t)}return e},e.prototype.getWholeText=function(t){for(var e="",i=t.childNodes.length,n=0;n<i;n++){var r=t.childNodes[n];8!==r.nodeType&&(e+=1!==r.nodeType?r.nodeValue:this.getWholeText(r))}return e},e.prototype.findPlaceForAdAuto=function(){this.log("findPlaceForAdAuto");var t=[],e=[],i=[],n=["SCRIPT","STYLE","TITLE","LABEL","HEADER","H2","LI","A","UL","FORM","FIGURE","NOSCRIPT","IFRAME"],r=["fixed","absolute"],a=this.d.body.getElementsByTagName("*"),s=this.d.body,o=this.d.documentElement,l=Math.max(s.scrollHeight,s.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight),h=this.d.createElement("div");h.id="sas_intextContainer_"+this.c.insertionId;for(var d=0,c=a;d<c.length;d++){var p=c[d],u=Math.round(p.parentNode.childElementCount+p.parentNode.clientHeight+p.parentNode.clientHeight+p.parentNode.offsetTop);if(!(n.indexOf(p.tagName)>-1||u<=10)){var v=void 0;p.firstChild&&3===p.firstChild.nodeType&&p.firstChild.length>150&&p.parentNode.offsetTop>300&&(v={node:p.firstChild,length:p.firstChild.length,parent:p.parentNode,value:p.firstChild.data,parentOffset:p.parentNode.offsetTop},t[u]||(t[u]=[]),t[u].push(v)),p.clientWidth>=300&&p.clientHeight>100&&p.parentNode.clientHeight>1.5*p.clientHeight&&p.parentNode.offsetTop>300&&p.offsetTop<.75*l&&"hidden"!==this.w.getComputedStyle(p.parentNode,null).getPropertyValue("overflow")&&-1===r.indexOf(this.w.getComputedStyle(p.parentNode,null).getPropertyValue("position"))&&(v={node:p,parent:p.parentNode,parentWidth:p.parentNode.clientWidth,parentId:u,offsetTop:p.parentNode.offsetTop},e[u]||(e[u]=[]),e[u].push(v)),p.clientWidth>=300&&p.clientHeight>100&&p.offsetTop>.75*this.w.innerHeight&&p.offsetTop<Math.max(.5*l,this.w.innerHeight)&&-1===r.indexOf(this.w.getComputedStyle(p,null).getPropertyValue("position"))&&(v={node:p,width:p.clientWidth,height:p.clientHeight,offsetTop:p.offsetTop},i.push(v))}}if(t.sort(function(t,e){return e.length-t.length}),this.log("article page",t),t[0]&&t[0].length>2){var y=t[0][0].parent,g=this.getWholeText(y).length;this.log("articleParentLength",g);for(var f=y.childNodes,m=0,b=0,w=0;w<f.length;w++)if(this.log("sum",m),(m+=this.getWholeText(f[w]).length)>g/3){this.log("break",m,g/3),b=w;break}return this.log("whichChild",b),this.log("articleChildren",f),y.insertBefore(h,f[b]),h}this.log("home page or short article",e),e.sort(function(t,e){return t[0].offsetTop-e[0].offsetTop||e[0].parentWidth-t[0].parentWidth}),this.log(e);for(var x=0,k=e;x<k.length;x++){var P=k[x];if(P&&P.length>1)return this.log("div collection with the same parent",e[P]),P[0].parent.insertBefore(h,P[1].node),h}return this.log("other2",i),i.length?(i.sort(function(t,e){return e.width-t.width||t.offsetTop-e.offsetTop}),this.log("other2",i),i[0].node.insertBefore(h,i[0].node.firstChild),h):null},e.prototype.buildTestContent=function(t){this.addCss("\n\t\t\t#iframeMob_"+this.c.insertionId+"{\n\t\t\t\twidth:330px;\n\t\t\t\theight:580px;\n\t\t\t\tposition:absolute;\n\t\t\t\ttop:88px;\n\t\t\t\tleft:46px;\n\t\t\t}\n\t\t\t#iframeDiv_"+this.c.insertionId+"{\n\t\t\t\tmargin:20px auto 0;\n\t\t\t\tposition:relative;\n\t\t\t\twidth:416px;\n\t\t\t\theight:742px;\n\t\t\t\tbackground-image:url(http://gallery.smartadserver.com/demo_mobile/image/Phone_Hybrid.png);\n\t\t\t}\n\t\t\ttable img{\n\t\t\t\tdisplay:none;\n\t\t\t}\n\t\t");var e="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris vestibulum ullamcorper orci et e\n\t\tleifend. Morbi a magna ac dolor porta condimentum. ut, commodo a enim. Nulla ac dui vel odio rutrum rh tellu\n\t\ts. Quisque euismod mattis massa. Integer laoreet sapien quis eros eleifend auctor. Aenean faucibus augue nec\n\t\t dolor congue posuere. Aliquam et massa tellus. Sed commodo, orci dictum porta scelerisque, risus neque vulp\n\t\t utate enim, sit amet fermentum dui velit ac erat. Aenean faucibus augue nec dolor congue posuere. Aliquam e\n\t\t t massa tellus. Sed commodo, orci dictum porta scelerisque, risus neque vulputate enim, sit amet fermentum \n\t\t dui velit ac erat.";e="<"+t.paragraphType+">"+e+"</"+t.paragraphType+">";for(var i="<div>"+e+"</div>",n="",r=0;r<4;r++)n+=e;e=n;for(var a="",s=0;s<2;s++)a+=i;i=a,"ad placement"===t.selectedPosition&&(t.selectedPosition="specified element by id",t.idNames=this.c.tagId);var o;o="paragraph by id"===t.selectedPosition||"specified element by id"===t.selectedPosition?"id":"class";var l=[];l=t.idNames.split(";"),""===l[l.length-1]&&l.splice(l.length-1,1);var h='<img src="http://www.saspreview.com/images/preview-dog.png" width="330" alt="" /><h1>This is\n\t\t an example of article</h1>';"specified element by id"===t.selectedPosition||"specified element by class name"===t.selectedPosition?h+=i+"<div "+o+'="'+l[0]+'"></div>'+i:h+="<div "+o+'="'+l[0]+'">'+e+"</div>";var d=this.addElement("div",this.d.body,{id:"iframeDiv_"+this.c.insertionId}),c=this.addElement("iframe",d,{src:"about:blank",width:330,height:590,frameBorder:"0",allow:"autoplay;fullscreen;",scrolling:"yes",marginheight:"0",marginwidth:"0",id:"iframeMob_"+this.c.insertionId}),p=c.contentWindow||c,u=c.contentDocument||c.contentWindow.document;u.open("text/html","replace"),u.write('<!DOCTYPE html><head></head><body style="padding:0;margin:0">'+h+"</body></html>"),u.close(),this.viewability.d=this.d=u,this.viewability.w=this.w=p},e.prototype.addOba=function(t,e,i){var n=this;this.log("addOba");var r=2===e?"top-left":"top-right";window.sas.utils.loadLinkCdn("diff/templates/js/adplayer/adplayer.css"),window.sas.utils.loadScriptCdn(["diff/templates/js/adplayer/adplayer.js","diff/templates/js/adplayer/adplayer.sas.js"],{onLoad:function(){n.w.$ADP&&(window.$ADP.sas.addOba(t,!1,r,n.c.sessionId,t,n.c.sessionId),i.style.width=n.c.creative.width+"px")}})},e.prototype.logRtbClick=function(t){var e=(new Date).getTime();return e-this.lastClicked>100&&(this.log("logRtbClick"),(new Image).src=t+"&rnd="+e,this.lastClicked=e,!0)},e.prototype.myIframeReady=function(t,e){var i=this,n=t.document;if(this.initViewability(e),this.c.statisticTracking.rtbbid){this.addEvent(n,"click",function(){i.logRtbClick(i.c.creative.creativeClickCountPixelUrl)});var r=n.getElementsByTagName("iframe"),a=r.length;if(!a)return;this.overIframe=!1;for(var s=0;s<a;s++){var o=r[s];o.onmouseover=function(){i.overIframe=!0},o.onmouseout=function(){i.overIframe=!1,i.w.focus()},this.addEvent(this.w,"blur",function(){i.overIframe&&i.logRtbClick(i.c.creative.creativeClickCountPixelUrl)})}}},e.prototype.initViewability=function(t){var e;this.viewability.init(t,(e={},e[this.c.creative.id]={viewable:[this.prepareTrackingUrl("viewcount",this.c.sessionId)],undetermined:[this.prepareTrackingUrl("viewUndetermined",this.c.sessionId)]},e))},e.prototype.validateParam=function(t,e){return e?"&"+t+"="+e:""},e}(r.Global));e.SasAd=s},3:function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),a=window.sas||{},s=function(t){function e(e){var i=t.call(this,e)||this;return i.c=e,i.dataLoaded=!1,i.dataToLog=null,i.videoDuration=0,i.creativesOrder=["video/mp4","video/webm","video/ogg","video/3gpp","application/javascript","application/x-javascript","audio/mpeg","audio/mp3"],i.vpaidType=["application/javascript","application/x-javascript"],i.player=null,i.firstPlay=!0,i.countImpression=!1,i.responseObj={adParameters:"",url:"",clickUrl:"",contentType:"",clickTrackings:[],vastTrackings:[],impPixels:[],errorTrackings:[],skipDelay:0,width:0,height:0},i.playerDestroyed=!1,i.interactiveCreativeFile=!1,i.interactiveCreativeFileError=!1,i.adPodId=Math.ceil(1e6*Math.random()).toString(),i.parsedData={ad:{},passback:null,type:""},i.fireCallbacks=!0,i.trackedOnce={start:!1,firstQuartile:!1,midpoint:!1,thirdQuartile:!1,complete:!1,skip:!1,exstart:!1,exfirstQuartile:!1,exmidpoint:!1,exthirdQuartile:!1,excomplete:!1},i.fullScreenFlag=!1,i.paused=!1,i.timeout=0,i}return n(e,t),e.prototype.triggerEvent=function(t){var e;this.d.createEvent?(e=this.d.createEvent("HTMLEvents"),e.initEvent(t,!0,!0)):(e=this.d.createEventObject(),e.eventType=t),e.eventName=t,"sasVideoDuration"!==e.eventName&&"adDuration"!==e.eventName||(this.dataLoaded&&!this.videoDuration&&this.playerDiv&&this.playerDiv.getElementsByTagName("video")&&(this.videoDuration=this.playerDiv.getElementsByTagName("video")[0].duration),e.videoDuration=this.videoDuration),e.formatId=this.c.formatId,this.d.createEvent?this.w.dispatchEvent(e):this.w.fireEvent("on"+e.eventType,e)},e.prototype.handleTriggerLog=function(t){this.log("handleTriggerLog",t);var e=Math.round(1e5*Math.random());if(t&&null!==t.errorCode){this.log("Parsing error");for(var i=null!=t.trackings?t.trackings:[],n=0,r=i;n<r.length;n++){var a=r[n];this.tracking(a)}this.tracking(this.prepareTrackingUrl("viewerror",e)),this.tracking(this.prepareTrackingUrl("noad",e)),this.triggerEvent("adError")}else t&&null===t.errorCode&&t.hasOwnProperty("key")&&"wrapper"===t.key?(this.log("wrapper"),this.tracking(this.prepareTrackingUrl("wrapper",e))):t&&null===t.errorCode&&t.hasOwnProperty("key")&&"vnoad"===t.key?(this.log("empty wrapper - vnoad"),this.tracking(this.prepareTrackingUrl("vnoad",e)),this.triggerEvent("adError")):(!1===t||null===t.errorCode&&t.hasOwnProperty("key")&&null===t.key)&&(this.log("Empty"),this.tracking(this.prepareTrackingUrl("noad",e)),this.triggerEvent("adError"),this.player&&this.closeAd())},e.prototype.sortCreatives=function(t){this.log("sortCreatives",t);for(var e={},i=0,n=this.creativesOrder;i<n.length;i++){var r=n[i];e[r]=[]}for(var a=0,s=t;a<s.length;a++){var r=s[a];e[r.type]&&e[r.type].push(r)}return e},e.prototype.chooseBestCreative=function(t){this.log("chooseBestCreative",t);var e=this.sortCreatives(t);this.log("aggregatedData",e);for(var i=0,n=this.creativesOrder;i<n.length;i++)for(var r=n[i],a=0,s=e[r];a<s.length;a++){var o=s[a];if(this.vpaidType.indexOf(r)>-1)return o;if(this.canPlayType(r))return o}return this.dataLoaded=!1,{contentType:"",height:0,width:0,url:""}},e.prototype.canPlayType=function(t){var e=this.d.createElement("video");return!(!e.canPlayType||!e.canPlayType(t))},e.prototype.prepareVideoParams=function(t){void 0===t&&(t=null),this.log("prepareVideoParams",t);var e=Math.round(1e5*Math.random());if(t&&t.ad.inLine.creatives[0].linear){var i=t.ad.inLine.creatives[0].linear,n=void 0,r=void 0,a=void 0;return null===i.mediaFiles.interactiveCreativeFile||this.interactiveCreativeFile?a=this.chooseBestCreative(i.mediaFiles.mediaFile):(this.interactiveCreativeFile=!0,a=this.chooseBestCreative(i.mediaFiles.interactiveCreativeFile)),(this.log("bestCreative",a),this.dataLoaded)?(this.responseObj.adParameters=null!==i.adParameters?i.adParameters.content:"",this.responseObj.url=a.content,null===i.videoClicks||null===i.videoClicks.clickThrough?this.responseObj.clickUrl=null:this.responseObj.clickUrl=i.videoClicks.clickThrough.content,"audio/mpeg"===a.type||"audio/mp3"===a.type?this.responseObj.contentType="video/mp4":this.responseObj.contentType=a.type,this.contentType=this.responseObj.contentType,this.responseObj.clickTrackings=null!==i.videoClicks?i.videoClicks.clickTrackings:[],this.responseObj.vastTrackings=null!==i.trackingEvents?i.trackingEvents:[],this.responseObj.impPixels=null!==t.ad.inLine.impression?t.ad.inLine.impression:[],this.responseObj.errorTrackings=null!==t.ad.inLine.error?t.ad.inLine.error:[],this.c.player.buttons.skipDelay&&(r=null!==i.skipoffset?new Date("January 1, 2000 "+i.skipoffset):new Date(1e3*this.c.player.buttons.skipDelay),this.responseObj.skipDelay=r.getSeconds()),n=null!==i.duration?new Date("January 1, 2000 "+i.duration):new Date("January 1, 2000 00:00:00"),this.videoDuration=60*n.getMinutes()+n.getSeconds(),this.responseObj.height=a.height,this.responseObj.width=a.width,this.responseObj):(this.log("Unsupported type"),void this.tracking(this.prepareTrackingUrl("error",e)))}if(null===t)return this.dataLoaded=!0,this.responseObj.contentType=this.getContentType(this.c.creative.url),"video/mp3"!==this.responseObj.contentType&&"audio/mpeg"!==this.responseObj.contentType&&"audio/mp3"!==this.responseObj.contentType||(this.responseObj.contentType="video/mp4"),this.contentType=this.responseObj.contentType,-1===this.creativesOrder.indexOf(this.contentType)?(this.log("Unsupported type"),this.dataLoaded=!1,this.tracking(this.prepareTrackingUrl("error",e)),void this.tracking(this.prepareTrackingUrl("noad",e))):(this.responseObj.clickUrl=this.c.creative.oryginalClickUrl,this.responseObj.url=this.c.creative.url,this.c.player.buttons.skipDelay&&(this.responseObj.skipDelay=this.c.player.buttons.skipDelay),this.responseObj)},e.prototype.getContentType=function(t){var e=t.slice(t.lastIndexOf(".")+1),i=e.length;return e.indexOf("?")>0&&e.indexOf("#")>0?i=e.indexOf("?")<e.indexOf("#")?e.indexOf("?"):e.indexOf("#"):e.indexOf("?")>0&&e.indexOf("#")<0?i=e.indexOf("?"):e.indexOf("?")<0&&e.indexOf("#")>0&&(i=e.indexOf("#")),"video/"+e.slice(0,i)},e.prototype.parserHandler=function(t,e){var i=null;switch(t.type){case"PUSH_AD":this.log("PUSH_AD",t),this.dataLoaded=!0,this.parsedData=t;break;case"PUSH_PASSBACK":null!=t.ad?(this.log("Passback",t),this.dataLoaded=!0,i=this.prepareVideoParams(t),this.player?this.loadPlayer(i):e(i)):(this.dataLoaded=!1,this.log("There is no passback"),this.handleTriggerLog(!1),this.player||e(i));break;case"TRIGGER_LOG":this.log("TRIGGER_LOG",t),this.dataToLog=t,this.handleTriggerLog(this.dataToLog);break;case"ADPOD_COMPLETED":if(this.log("ADPOD_COMPLETED",this.dataLoaded,this.parsedData,this.dataToLog),this.dataLoaded||null!==this.dataToLog){if(this.dataLoaded){if(i=this.prepareVideoParams(this.parsedData),this.dataLoaded)return e(i);this.parserInstance.passback(this.adPodId,Math.round(1e5*Math.random()).toString())}}else this.handleTriggerLog(!1)}},e.prototype.getCreative=function(t){var e=this;if(this.log("getCreative"),0!==this.c.creative.type){this.log("creative from manage");var i=this.prepareVideoParams();return t(i)}this.log("vast parser"),window.sas.utils.loadScriptCdn("/diff/templates/js/parser/prod/vast-parser.js",{async:!0,onLoad:function(){var i=window.sas.video.VASTParser;e.parserInstance=i.getVASTParserInstance();var n={maxVASTRedirections:7,podSize:1,requestTimeout:8e3,supportedVASTVersion:4};e.parserInstance.load(e.adPodId,function(i){e.parserHandler(i,t)},e.c.creative.agencyCode.replace(/^\s+|\s+$/g,""),n)}})},e.prototype.mapContentType=function(t){var e=t.toUpperCase();return e="audio/mpeg"===t?"MP3":t.indexOf("/x-")>-1?e.replace(/.*\/X-/,"x"):e.replace(/.*\//,""),this.log("mapContentType: "+e),e},e.prototype.addPlayer=function(t,e,i,n,r,s,o,l){var h=this;void 0===o&&(o=0),this.log("addPlayer",t,e,i),this.contentType=this.contentType||i.contentType,this.responseObj=i,this.playerDiv=e,this.timeout=o,this.closeAd=function(){s&&s(),setTimeout(function(){h.log("destroy player"),h.player.destroy(),h.player=null,h.playerDestroyed=!0},1e3*o+1)},a.utils.loadScriptCdn("/diff/templates/js/outstream/current/sas-outstream.js?v=20181017",{async:!0,onLoad:function(){h.log("outstream lib loaded"),e.id&&h.addCss("\n\t\t\t\t\t\t#"+e.id+" div.sas-linear .sas-ctrl-panel{\n\t\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, "+t.bar.barOpacity+");\n\t\t\t\t\t\t}");var o={slot:e,autoHideControls:t.buttons.autohide,barMode:a.video.player.Outstream.BarModes[t.bar.barMode],loop:t.videoLoop,mute:t.startMuted,scaleMode:a.video.player.Outstream.ScaleModes[t.scaleMode],enableBtnFullScreen:{video:t.buttons.fullscreenButton,vpaid:t.buttons.fullscreenButton},enableBtnPause:{video:t.buttons.playPauseButton,vpaid:t.buttons.playPauseButton},enableBtnPlay:{video:t.buttons.playPauseButton,vpaid:t.buttons.playPauseButton},enableBtnSkip:{video:t.buttons.skip,vpaid:t.buttons.skip},enableBtnVolume:{video:t.buttons.volumeButton,vpaid:t.buttons.volumeButton},enableBtnReplay:{video:t.buttons.replay,vpaid:t.buttons.replay},labelCtrlCountDown:{video:function(){return t.durationLabel},vpaid:function(){return t.durationLabel}},enableCtrlCountDown:{video:t.enableCtrlCountDown,vpaid:t.enableCtrlCountDown},enableCtrlSkipCountDown:{video:t.enableCtrlSkipCountDown,vpaid:t.enableCtrlSkipCountDown},labelCtrlSkipCountDown:{video:function(){return!t.buttons.forcedCloseButton&&t.skipLabel},vpaid:function(){return!t.buttons.forcedCloseButton&&t.skipLabel}}},d=function(t){h.onPlayerEvent(t.type,function(t){return n(t)},function(){return r()},function(){return s()},t,l)};h.log("videoConfig",o);var c=!1,p=h.isMobile();h.player=new a.video.player.Outstream(o);var u=function(){h.log("success callback"),h.player.setHandler(d),h.loadPlayer(i)},v=function(){h.log("error callback"),h.addEvent(h.w,"touchmove",y),h.addEvent(h.w,"touchend",g),h.player.destroy(),h.player=new a.video.player.Outstream(o)},y=function(){c=!0},g=function(){c?c=!1:(h.w.removeEventListener("touchmove",y),h.w.removeEventListener("touchend",g),h.player.init(null),u())};p?h.player.init(null,u,v):(h.player.init(null),h.player.setHandler(d),h.loadPlayer(i))}})},e.prototype.mapVpaidEventName=function(t){var e={AdSkipped:"skip",AdStarted:"creativeView",AdVideoStart:"start",AdVideoFirstQuartile:"firstQuartile",AdVideoMidpoint:"midpoint",AdVideoThirdQuartile:"thirdQuartile",AdVideoComplete:"complete",AdPaused:"pause",AdError:"error",AdPlaying:"resume",AdClickThru:"click",AdSizeChange:"fullscreen"};return e[t]&&(t=e[t]),t},e.prototype.countImpressionFunc=function(){if(!this.countImpression){if(this.log("Counting impression"),this.countImpression=!0,this.c.creative.creativeCountPixelUrl&&this.tracking(this.c.creative.creativeCountPixelUrl),this.responseObj.impPixels&&this.responseObj.impPixels.length)for(var t=0,e=this.responseObj.impPixels;t<e.length;t++){var i=e[t];this.tracking(i.content)}if(this.c.trackingUrl){var n=[];n=this.c.trackingUrl.split("||"),""===n[n.length-1]&&n.splice(n.length-1,1);for(var r=0,a=n;r<a.length;r++){var s=a[r];this.tracking(s)}}}},e.prototype.filterTracking=function(t,e){if(t&&this.trackedOnce.hasOwnProperty(t)){if(!0===this.trackedOnce[t])return this.log("event "+t+" filtered"),!1;this.trackedOnce[t]=!0}for(var i=0,n=e;i<n.length;i++){var r=n[i];this.tracking(r)}return!0},e.prototype.onPlayerEvent=function(t,e,i,n,r,a){var s=this,o=Math.round(1e5*Math.random()),l=["click","complete","error","exitFullscreen","firstQuartile","fullscreen","midpoint","mute","pause","progress","resume","playerCollapse","playerExpand","skip","start","thirdQuartile","unmute"];if(this.vpaidType.indexOf(this.contentType)>-1&&(t=this.mapVpaidEventName(t)),void 0!==r&&void 0!==r.data&&!0===r.data.mute&&(t="mute"),void 0!==r&&void 0!==r.data&&!1===r.data.mute&&(t="unmute"),"playerExpand"===t?t="fullscreen":"playerCollapse"===t&&(t="exitFullscreen"),-1!==l.indexOf(t)){this.log("onPlayerEvent: "+t),this.viewability.videoHandler(t,this.c.creative.id),e&&e(t),this.firstPlay&&"start"===t&&(this.firstPlay=!1,this.countImpression||this.countImpressionFunc(),this.player&&this.player.show(),i&&(i(),!this.c.player.buttons.forcedCloseButton||"JAVASCRIPT"!==this.mapContentType(this.contentType)&&"SWF"!==this.mapContentType(this.contentType)||this.forceCloseButton(this.playerDiv.parentElement),this.player&&this.w.setTimeout(function(){s.player.resize(s.playerDiv.clientWidth,s.playerDiv.clientHeight,"NORMAL")},1e3*this.timeout)),this.fireCallbacks&&(this.triggerEvent("sasVideoStart"),this.triggerEvent("adBegin"),this.triggerEvent("sasVideoDuration"),this.triggerEvent("adDuration")));var h=this.interactiveCreativeFile&&"error"===t?409:Number();if(this.filterTracking(t,[this.prepareTrackingUrl(t,o,h)]),"click"===t&&(this.responseObj.clickUrl||this.vpaidType.indexOf(this.contentType)>-1)&&this.c.creative.creativeClickCountPixelUrl&&this.tracking(this.c.creative.creativeClickCountPixelUrl),this.responseObj.clickTrackings&&this.responseObj.clickTrackings.length&&"click"===t)for(var d=0,c=this.responseObj.clickTrackings;d<c.length;d++){var p=c[d];this.tracking(p.content)}if(this.responseObj.vastTrackings){for(var u=[],v=0,y=this.responseObj.vastTrackings;v<y.length;v++){var p=y[v];(p.event===t||"fullscreen"===t&&"playerExpand"===p.event||"exitFullscreen"===t&&"playerCollapse"===p.event)&&u.push(p.content)}u.length&&this.filterTracking("ex"+t,u)}if("click"===t&&-1===this.vpaidType.indexOf(this.contentType)&&this.w.open(this.responseObj.clickUrl),"error"===t){if(this.responseObj.errorTrackings)for(var g=0,f=this.responseObj.errorTrackings;g<f.length;g++){var m=f[g];this.tracking(m)}this.interactiveCreativeFile&&!this.interactiveCreativeFileError?(this.log("interactiveCreativeFile was wrong - get another file"),this.interactiveCreativeFileError=!0,this.loadPlayer(this.prepareVideoParams(this.parsedData))):!1===this.countImpression&&this.parserInstance&&this.parserInstance.passback(this.adPodId,o.toString())}this.player&&("skip"===t||"complete"===t&&!this.c.player.videoLoop&&!a||"exitFullscreen"===t&&this.fullScreenFlag)&&(!this.fireCallbacks||"skip"!==t&&"complete"!==t||(this.triggerEvent("sasVideoEnd"),this.triggerEvent("adEnd")),this.fullScreenFlag&&(this.fullScreenFlag=!1,this.tracking(this.prepareTrackingUrl("exitFullscreen",o))),this.closeAd())}},e.prototype.loadPlayer=function(t){this.log("loadPlayer",t);var e=this.mapContentType(t.contentType),i={url:t.url,contentType:a.video.player.Outstream.MimeTypes[e],skipDelay:t.skipDelay};this.vpaidType.indexOf(t.contentType)>-1&&(i.adParameters=t.adParameters),this.log("loadConfig",i),this.player.load(i),this.player.play()},e.prototype.onMouseOverUnMute=function(t,e,i){var n=this;this.addEvent(t,"mouseover",function(){try{e&&e.unmute(),i&&i()}catch(t){n.log("Error: "+t)}})},e.prototype.onMouseOutMute=function(t,e,i){var n=this;this.addEvent(t,"mouseout",function(){try{e&&e.mute(),i&&i()}catch(t){n.log("Error: "+t)}})},e.prototype.pauseOnTabChange=function(t,e){var i=this;"application/javascript"!==e&&(this.w.onblur=function(){if(!i.playerDestroyed)try{i.log("onblur"),t.pause()}catch(t){i.log("Error: "+t)}},this.w.onfocus=function(){if(!i.playerDestroyed)try{i.log("onfocus"),i.paused||t.play()}catch(t){i.log("Error: "+t)}})},e.prototype.forceCloseButton=function(t){var e=this;this.log("forceCloseButton"),this.w.setTimeout(function(){e.addElement("img",t,{id:"sas_backupCloseButton_"+e.c.insertionId,src:e.closeButtonUrl,alt:""}).onclick=function(){e.onPlayerEvent("skip")}},1e3*this.c.player.buttons.skipDelay)},e.prototype.requestAnimFrame=function(t){return this.w.requestAnimationFrame(t)||this.w.webkitRequestAnimationFrame(t)||this.w.mozRequestAnimationFrame(t)},e.prototype.chooseBestCreativeFromManage=function(t){if(0===t[0].type)return this.c.creatives[0];for(var e=[],i=0,n=t;i<n.length;i++){var r=n[i];e.push({adaptiveStreaming:"",apiFramework:"",bitrate:0,codec:"",content:r.url,delivery:"",height:r.height,id:r.id.toString(),maintainAspectRatio:!1,maxBitrate:"",minBitrate:"",scalable:!1,type:this.getContentType(r.url),width:r.width})}for(var a=this.chooseBestCreative(e),s=0,o=t;s<o.length;s++){var r=o[s];if(r.id===Number(a.id))return r}return null},e.prototype.refreshCanvas=function(t,e,i,n){var r=this;this.closed||(this.requestAnimFrame(function(){return r.refreshCanvas(t,e,i,n)}),e.drawImage(t,0,0,i,n))},e}(r.SasAd);e.SasVideo=s}});