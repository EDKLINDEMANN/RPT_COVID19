(function(n){n.PbaSiteTracker_GlobalConfigs={url:"https://st.pba.xl.pt/pbasitetracker/a.ashx",useSiteCookie:!1,siteID:"site id",suid:"user id",extraArgs:[{name:"cid",value:"COF"}]};n.PbaSiteTracker=new function(){function ht(){if(!i)while(a.length>0){var n=a.shift();n.action.apply(st,n.args)}}function u(n,t,i){return Object.keys(t).forEach(function(r){(i||n[r]===undefined)&&(n[r]=t[r])}),n}function g(n,t){var u="",r,i,f,e;return it(n)&&(t?(r=0,i=Object.keys(n).reduce(function(t,i){var u=encodeURIComponent(i)+"="+encodeURIComponent(n[i]==undefined?"":n[i].toString());return r+=u.length+1,t[i]=u,t},{}),r>t&&(f=r-t,e=v.reduce(function(n,t){return n+(i[t]||"").length},0),v.forEach(function(n){if(i[n]){var t=i[n].length,r=Math.ceil(t/e*f);i[n]=i[n].substring(0,t-r)}})),u=Object.keys(i).map(function(n){return i[n]}).join("&")):u=Object.keys(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t]==undefined?"":n[t].toString())}).join("&")),u}function h(){if(arguments.length){var n=arguments.length===1?null:Array.apply(null,arguments).slice(1),t={action:arguments[0],args:n};a.push(t)}}function nt(){return""}function tt(){var n,t;if(navigator){if(n=/iPad|iPhone/.exec(navigator.platform))return n;if(n=/ARM/.exec(navigator.platform))return t=/Windows Phone/.exec(navigator.appVersion),n+" "+t;if(n=/Win32|Linux/.exec(navigator.platform))return(t=/Android/.exec(navigator.appVersion))?t:(t=/Microsoft Internet Explorer/.exec(navigator.appName)||/OPR/.exec(navigator.appVersion)||/Chrome|Safari/.exec(navigator.appVersion)||/Netscape/.exec(navigator.appName))?n+" "+t:n}return"Unknown"}function it(n){return n===null?!1:n instanceof Function||n instanceof Object&&!Array.isArray(n)}function c(n){var t={};return it(n)?Object.keys(n).forEach(function(i){i!=undefined&&(t[i]=n[i])}):Array.isArray(n)&&n.forEach(function(n){var r,e,i,f,u,o;if(n&&n.name)if(n.selector){for(r=n.selector.split(/([\.@#][a-z:=\d]+)/gi).filter(function(n){return n}),e="*",n.selector.match(/^\w/)&&(e=r[0],r.splice(0,1)),i=Array.apply([],document.getElementsByTagName(e)),f=0;f<r.length&&i.length>0;f++)u=r[f],i=i.filter(function(n){var t,i,r;switch(u[0]){case".":return t=n.getAttribute("class"),t.indexOf(u.substr(1))>=0;case"#":return t=n.getAttribute("id"),t.indexOf(u.substr(1))>=0;case"@":return i=u.split("="),r=n.getAttribute(i[0].substr(1)),r?i.length>1?r==i[1]:!0:!1;default:return!1}});i.length>0&&(o=n.value,n.value&&n.value[0]=="@"&&(o=i[0].getAttribute(n.value.substring(1))),t[n.name]=o)}else n.value&&(t[n.name]=n.value)}),t}function r(n){var r=t.url+"?___hash="+(new Date).getTime()+"&callback=PbaSiteTracker.OnInitDone&",i,u;r+=g(n,2048-r.length);i=document.createElement("script");i.type="text/javascript";i.async=!0;i.src=r;i.onload=i.onreadystatechange=function(){};u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(i,u)}function y(){var n="",t=document.cookie.indexOf(o);return t>=0&&(n=document.cookie.substr(t+o.length+1),t=n.indexOf(";"),t>=0&&(n=n.substr(0,n.indexOf(";")))),n||(n=localStorage.getItem(o)||""),rt.test(n)?n:!1}function ut(n){var t=new Date;t.setFullYear(t.getFullYear()+100,0,0);localStorage.setItem(o,n)}function f(n,t,i){n!=null&&typeof n!="undefined"&&(n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i)}function ct(n,t){if(n&&!n.__pbasitetracker_observer){var i=new MutationObserver(function(n){n.forEach(function(n){[].concat.apply([],n.addedNodes).forEach(function(n){if(n.nodeType==1){var i=n.getElementsByTagName("a"),r=n.nodeName=="A"?[n]:[];[].concat.apply(r,i).forEach(function(n){n.getAttribute("href")&&n.__pbasitetracker_event_set!=!0&&(n.__pbasitetracker_event_set=!0,f(n,"click",t))})}})})});i.observe(n,{childList:!0,subtree:!0});n.__pbasitetracker_observer=i}}function ft(){var n=document.getElementsByTagName("a"),t;p!==n.length&&(p=n.length,t=[].concat.apply([],n),t.forEach(function(n){n.getAttribute("href")&&n.__pbasitetracker_event_set!=!0&&(n.__pbasitetracker_event_set=!0,f(n,"click",PbaSiteTracker.linkClicked))}));setTimeout(function(){ft()},1e3)}function et(n){var t,r,i;if(n==null)return"";if(n.nodeName.toLowerCase()=="html")return n.nodeName.toLowerCase();if(t=n.nodeName.toLowerCase(),n.parentNode!=null&&n.parentNode.childNodes.length>0){for(r=0,i=0;n.parentNode.childNodes[i]!=n;i++)n.parentNode.childNodes[i].nodeType==1&&r++;t+="["+r+"]"}return n.className!=""&&(t+="."+n.className),n.id&&(t+="#"+n.id),et(n.parentNode)+">"+t}function lt(n){for(var t={x:0,y:0};n.offsetParent!=null;)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;return t}function at(){return{x:document.body.scrollLeft||document.documentElement.scrollLeft||n.pageXOffset||0,y:document.body.scrollTop||document.documentElement.scrollTop||n.pageYOffset||0}}function ot(t,i){var r=((t.getAttribute?t.getAttribute("target"):t.target)||"").toLowerCase();r!=="_self"&&r!==""||i.ctrlKey||i.altKey||i.shiftKey||i.metaKey||i.which==2||i.defaultPrevented||setTimeout(function(i){return function(){return i.defaultPrevented||(i.preventDefault(),clearTimeout(w),w=setTimeout(function(){n.location.href=t.getAttribute?t.getAttribute("href"):t.href},50)),null}}(i),0)}function vt(){if(document.readyState==="complete")return setTimeout(e,1);f(document,"DOMContentLoaded",e);f(document,"readystatechange",e);f(n,"load",e)}function e(){var n,u,o,f;i&&!s&&(l+=l,n=!1,u=y(),t.useSiteCookie==!0?u?setTimeout(function(){PbaSiteTracker.OnInitDone({success:!0,uid:u})},0):(n=!0,f={a:"_nuid"},r(f),t.uid=null):(o=u?!1:!0,f={a:"_cuid",n:o},n=!0,r(f)),n&&(s=!0,k=setTimeout(function(){s=!1},1e4)));i&&setTimeout(e,l)}var t={url:"",uid:"",useSiteCookie:!1,trackPageOnInit:!1,siteID:"",suid:""},b=!0,o="__PWL",l=100,i=!0,s=!1,k=null,st=this,d=[],a=[],v,rt,p,w;setInterval(ht,300);v=["DOMpath","href"];rt=/[0-9a-f]{32}/;p=0;w=0;this.OnInitDone=function(n){if(n.success)if(t.useSiteCookie===!0)n.uid&&(ut(n.uid),t.uid=n.uid);else if(n.uid)ut(n.uid),t.uid=n.uid;else{var u=y();r({a:"_suid",uid:u});return}PbaSiteTracker.InitDone&&PbaSiteTracker.InitDone(n);i=!1;t.trackPageOnInit&&PbaSiteTracker.trackPage()};this.InitDone=null;this.callbackReceived=function(n){n&&n.method&&n.method(n.arg);clearTimeout(k);s=!1};this.linkClicked=function(i){for(var h=i?i:n.event,f=i.currentTarget?i.currentTarget:i.srcElement;f.nodeName.toLowerCase()!="a"&&f!=null;)f=f.parentNode;if(f!=null){var e=lt(f),o=at(),l=new Date,s={a:"_tl",date:l.getTime(),siteid:t.siteID,uid:t.uid,text:f.textContent.trim(),referrer:document.referrer,url:document.location,href:f.href,DOMpath:et(f),browser:nt(),containsImage:f.getElementsByTagName("img").length>0?"true":"false",linkPosition:"("+e.x+","+e.y+")",scrollPosition:"("+o.x+","+o.y+")",suid:t.suid,platform:tt()},a=c(n.PbaSiteTracker_GlobalConfigs&&n.PbaSiteTracker_GlobalConfigs.extraArgs||[]);s.cookie=t.useSiteCookie===!1;r(u(s,a,!0));b&&ot(f,h)}};this.setUID=function(n){t.uid=n};this.getUID=function(){return y()};this.track=function(f,e,o){var s,l,a,v,y;if(i)return h(arguments.callee,f,e);s=o||document.location;l=d.indexOf(s)>=0;l||(d.push(s),a=new Date,v={a:f,date:a.getTime(),siteid:t.siteID,uid:t.uid,url:s,referrer:document.referrer,browser:nt(),suid:t.suid,platform:tt(),cookie:t.useSiteCookie===!1},e=(Array.isArray(e)?e:[e]).concat(n.PbaSiteTracker_GlobalConfigs&&n.PbaSiteTracker_GlobalConfigs.extraArgs||[]),y=c(e),r(u(v,y,!0)))};this.trackPageUrl=function(n,t){this.track("_tp",t,n)};this.trackPage=function(n){this.track("_tp",n)};this.trackLinks=function(){if(i)return h(arguments.callee,null);setTimeout(function(){ft();n.MutationObserver&&ct(document.body,PbaSiteTracker.linkClicked)},0)};this.trackRecommendation=function(f,e){var l;if(i)return h(arguments.callee,f,e);var o=f?f:n.event,s=o&&(o.currentTarget?o.currentTarget:o.srcElement),a=new Date,v={a:"_tr",date:a.getTime(),siteid:t.siteID,uid:t.uid,url:document.location,href:s&&s.href||"",cookie:t.useSiteCookie===!1};e=(Array.isArray(e)?e:[e]).concat(n.PbaSiteTracker_GlobalConfigs&&n.PbaSiteTracker_GlobalConfigs.extraArgs||[]);l=c(e);r(u(v,l,!0));b&&ot(s,o)};this.trackRecommendationViewed=function(f,e){var l;if(i)return h(arguments.callee,f,e);var o=f?f:n.event,s=o&&(o.currentTarget?o.currentTarget:o.srcElement),a=new Date,v={a:"_tv",date:a.getTime(),siteid:t.siteID,uid:t.uid,url:document.location,href:s&&s.href||"",cookie:t.useSiteCookie===!1};e=(Array.isArray(e)?e:[e]).concat(n.PbaSiteTracker_GlobalConfigs&&n.PbaSiteTracker_GlobalConfigs.extraArgs||[]);l=c(e);r(u(v,l,!0))};this.Init=function(i){u(t,n.PbaSiteTracker_GlobalConfigs,!0);u(t,i,!0);vt()}}})(window);