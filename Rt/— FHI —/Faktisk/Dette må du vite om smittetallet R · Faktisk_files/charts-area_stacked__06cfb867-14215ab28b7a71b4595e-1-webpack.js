(window.webpackJsonp=window.webpackJsonp||[]).push([["infogram-charts/charts-area~infogram-charts/charts-area_stacked~infogram-charts/charts-area_stacked_~06cfb867"],{"/6f4":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return s}));var n=a("JPcv"),i=a("ZBKM");function s(e){if(e.get("isFreelayoutInline")){var t=Object(n.fromJS)(e.attributes);t=t.withMutations((function(e){if(e.delete("chart_id"),e.delete("isFreelayoutInline"),e.delete("template"),e.delete("dataSets"),e.delete("interlinkedCharts"),e.delete("tabs"),e.deleteIn(["custom","height"]),e.deleteIn(["custom","map_json"]),e.deleteIn(["custom","yminraw"]),e.deleteIn(["custom","ymaxraw"]),e.deleteIn(["custom","xminraw"]),e.deleteIn(["custom","xmaxraw"]),e.deleteIn(["custom","y2minraw"]),e.deleteIn(["custom","y2maxraw"]),e.deleteIn(["custom","pointSizeminraw"]),e.deleteIn(["custom","pointSizemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangeminraw"]),e.get("sheets_settings"))for(var t=0;t<e.get("sheets_settings").size;t++){e.getIn(["sheets_settings",t])&&(e.deleteIn(["sheets_settings",t,"yminraw"]),e.deleteIn(["sheets_settings",t,"ymaxraw"]),e.deleteIn(["sheets_settings",t,"xminraw"]),e.deleteIn(["sheets_settings",t,"xmaxraw"]),e.deleteIn(["sheets_settings",t,"y2minraw"]),e.deleteIn(["sheets_settings",t,"y2maxraw"]),e.deleteIn(["sheets_settings",t,"pointSizeminraw"]),e.deleteIn(["sheets_settings",t,"pointSizemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangeminraw"]))}})),Object(i.default)(e.get("chart_id"),t,e)}}},"0Qba":function(e,t,a){"use strict";a.r(t),function(e){var n=a("LvDl"),i=a.n(n),s={load:function(t,a,n){var r=t.split(","),o=s.shapes;if(window.inlineShapes&&i.a.each(r,(function(e){var t="".concat(e,"Path");window.inlineShapes[t]&&(o[t]=window.inlineShapes[t])})),(t=r.filter((function(e){if(!o["".concat(e,"Path")])return e}))).length){var c;if(null===(c=window.app)||void 0===c?void 0:c.crm)return e.get("".concat("/api/shapes","/342,454"),i.a.bind((function(e){e&&i.a.each(e,(function(e){var t="".concat(e.title,"Path");o[t]={dimensions:e.dimensions,searchkey:e.searchkey,path:e.path,title:t}}))}),this),"json").then(a);var l=e.get("".concat("/api/shapes","/").concat(i.a.uniq(t).join(",")),i.a.bind((function(e){e&&i.a.each(e,(function(e){var t="".concat(e.title,"Path");o[t]={dimensions:e.dimensions,searchkey:e.searchkey||e.title,path:e.path,title:t}}))}),this),"json");return l.then(a).fail(n),l}a()},shapes:{},getShapes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=t.toLowerCase();var n=s.shapes,r=a?{}:[];return Object.keys(n).forEach((function(s){var o=n[s],c=!0;if(!t||o.searchkey&&-1!==o.searchkey.toLowerCase().indexOf(t)?e&&o.usergroup!==e&&(c=!1):c=!1,i.a.get(o,"dimensions.width")){var l=Math.max((32-o.dimensions.width)/2,0),h=Math.max((32-o.dimensions.height)/2,0),u={transform:"translate(".concat(l," ").concat(h,")")};o=i.a.extend(o,u)}c&&(a?r[s]=o:r.push(o))})),r},loadShapesForPrezigram:function(){var e=/\r\n|\t|\r|\n/g;fetch("/api/v1/prezigram/legacyShapes",{credentials:"same-origin"}).then((function(e){if(200!==e.status)throw new Error("Error loading shapes");return e.json()})).then((function(t){i.a.each(t,(function(t){var a=t.title+"Path";s.shapes[a]={path:t.path.replace(e," "),dimensions:t.dimensions,title:a,searchkey:t.searchkey||t.title,usergroup:t.usergroup}}))}))}};t.default=s}.call(this,a("+hRF"))},"44T1":function(e,t,a){"use strict";a.r(t),a.d(t,"addRenderQueue",(function(){return r})),a.d(t,"render",(function(){return o}));var n=a("3y/1"),i=!1,s=[];function r(e){s.push(e),i||o()}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i=!0,requestAnimationFrame((function(){for(var t,a=0;a<e&&(t=s[a]);a++)Object(n.isElementAttached)(t.container.node())&&(delete t.legendData,t.render());s.splice(0,a),s.length?o(e):i=!1}))}},"474q":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return c}));var n=a("LvDl"),i=a.n(n),s=a("Z8Pq");function r(e,t){var a=[];return function(n){var s,r=a.indexOf(n);if(-1===r){var o=a.length;a.push(n),s=function(e){return e.data=e.data||[],e.rawData=e.rawData||[],e.links=e.links||[],e}(i.a.merge({},t,{title:n,type:"line-area",index:o})),e.series.push(s)}else s=e.series[r];return s}}function o(e,t,a,n){return function(i){var r=i.row,o=i.link,c=r[0],l=r[1],h=r[2],u=r[3],f=Object(s.replaceBlank)(r[4]),d=e(f),p=t(c),g=[Number(a(l)),Number(a(h)),Number(a(u))],m=[l,h,u];d.data[p]=g,d.rawData[p]=m,d.dataLabels=[n[1],n[2],n[3]],d.links.push(o)}}function c(e){var t=e.options,a=e.emptySheet,n=e.createNumberParser;function c(c,l){var h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=i.a.merge({},a),f=i.a.merge({},u.series[0]),d=h?c.map((function(e){return e[0]})):c[0]||[],p=t.sheetnames&&t.sheetnames[l],g=n.call(e,l+1);u.series=[],u.categories.data=[],u.categories.title=Object(s.replaceBlank)(p||d[0]);var m=r(u,f),v=Object(s.categoryHelper)(u);return t.sheets.push(u),o(m,v,g,d)}return{default:Object(s.createImportFn)((function(e,t){var a=c(e,t);e.forEach((function(e,t){0!==t&&a(Object(s.getRowValuesAndLink)(e,s.extractCell))}))})),transposed:Object(s.createImportFn)((function(e,t){for(var a=c(e,t,!0),n=Object(s.getMaxColCount)(e),r=[],o=1;o<n;o++){for(var l=[],h=0;h<5;h++){var u=i.a.get(e,"[".concat(h,"][").concat(o,"]"));l.push(u)}r.push(l)}r.forEach((function(e){a(Object(s.getRowValuesAndLink)(e,s.extractCell))}))}))}}},"6jAQ":function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"getChartType",(function(){return C}));var n=a("XzT5"),i=a("LvDl"),s=a.n(i),r=a("SC+/"),o=a("44T1"),c=a("wrGL"),l=a("ibon"),h=a("JnWj"),u=a("pLmG"),f=a("0Qba"),d=a("/6f4"),p=a("6LTm"),g=a("tcv8"),m=a("S99L"),v=a("Oq5T"),b=a("wUcv"),y=a("SdvQ"),x=a("h7h9"),O=a("pWQL");function S(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);Object(x.removeEntity)(e)}function C(e){return(e.getChartInstance()||e).chart.getTypeMod()}function I(e,t){var a=t.decimalSeparator,n=t.groupingSymbol,i=t.decimalPlaces,r=t.decimalPlacesValue;n&&s.a.set(e,"grouping","none"===n?"":n);var o=!1===a;s.a.set(e,"decimal",o?".,":a),s.a.set(e,"numberParser",new h.default(o?"legacy":"firstNumber",a)),i&&void 0!==r&&s.a.set(e,"decimalPlaces",r)}var j=["font-size","font-family","font-weight","font-style"],E=["sheetSwitch.style.tab","pictorialBar.style.graph.item.value"];var T,N,D=[".,",".",","],P=[O.PICTORIAL_GRID,O.PICTORIAL_SIZE,O.MAP,O.TABLE,O.PICTORIAL_BAR,O.FACTS_AND_FIGURES],A=[O.MAP,O.TABLE,O.FACTS_AND_FIGURES],_=["edit","capture","download","thumbnail"];function R(e){switch(e){case O.PICTORIAL_GRID:case O.PICTORIAL_SIZE:case O.GAUGE:return 250;case O.PICTORIAL_BAR:case O.TIMER:case O.BAR_PROGRESS:return 70;default:return 400}}t.default={instanceClass:null,defaultHeight:400,defaultCategoryHeight:40,defaultCategoryWidth:40,defaultShape:"boyPath",initialize:function(e){var t=this;return this.initVariables(e),this.loadingShapes&&this.cleanup(),this.loadShapes().then((function(){return t.setupChartOptions(),t.setupChartOptionsStyle(),t.setupChartOptionsCustomStyle(),t.createInstance()}))},loadShapes:function(){var t=this,a=e.Deferred(),n=this.custom,i=this.chart.getTypeMod(),r=[];if(-1!==P.indexOf(i)){if(i===O.FACTS_AND_FIGURES){var o=/^[a-zA-Z0-9-_]+$/;this.chart.get("data").forEach((function(e){e.forEach((function(e){if(e&&e[2]){var t="string"==typeof e[2]?e[2]:"";s.a.has(e,"[2].value")&&(t=e[2].value);var a=t.toString().trim();(function(e){return o.lastIndex=0,!(!e||e.length>64)&&o.test(e)})(a)&&r.push(a)}}))}))}else{var c="defaultPath";switch(i){case O.PICTORIAL_SIZE:n[c]=n[c]||"circlePath";break;case O.MAP:n[c="path"]=n[c]||"circlePath";break;case O.TABLE:n[c]=n[c]||"circlePath";break;case O.PICTORIAL_BAR:c="path"}r=[s.a.has(n,c)&&n[c]||"boy"],n.shapes&&(r=r.concat(n.shapes)),this.sheetSettings&&this.sheetSettings.forEach((function(e){e&&e[c]&&r.push(e[c]),e&&e.shapes&&(r=r.concat(e.shapes))}))}if(i===O.TABLE)this.chart.get("data").forEach((function(e){e.forEach((function(e){e.forEach((function(e){(e=Object(v.default)(e,{assets:t.assets})).shape&&r.push(e.shape)}))}))}));var l=s.a.map(r,(function(e){return e?e.replace("Path",""):""}));this.loadingShapes=f.default.load(l.join(","),(function(){a.resolve(),t.loadingShapes=void 0}),(function(){return a.resolve()}))}else a.resolve();return a},cancelRender:function(){this.delayedRender&&(this.freeLayout||"embed"!==this.viewMode&&"web"!==this.viewMode?clearTimeout(this.delayedRender):cancelAnimationFrame(this.delayedRender),this.delayedRender=null)},initVariables:function(e){var t,a,n=e.chart,i=e.theme,r=e.id,o=e.sheetIndex,c=e.data,l=e.tabs,h=e.freeLayout,u=e.disableColumnSheets,f=e.interactivityHintEnabled,d=e.viewMode,p=e.scale,g=e.observer,m=e.container,v=e.animate,b=void 0===v||v,y=e.onSheetClick,x=e.captureSheetIndex,S=e.assets;this.chart=n,this.theme=i,this.onSheetClick=y,this.captureSheetIndex=x,this.id=r||n.get("chart_id"),this.sheetIndex=o,this.initializeData(c||n.get("data")),this.custom=n.get("custom"),this.colors=n.get("colors"),this.sheetSettings=n.get("sheets_settings"),this.themeColors=i.get("colors")||[],this.themeFont=i.get("font")||{},this.themeStyleColor=i.get("color")||{},this.charts=(t=i.get("charts"),a=s.a.merge({},t),E.forEach((function(e){var t=s.a.get(a,e);void 0!==t&&j.forEach((function(e){s.a.has(t,e)&&(t[s.a.camelCase(e)]=t[e],delete t[e])}))})),a),this.displayTabs=!!l,this.freeLayout=!!h,this.disableColumnSheets=!!u,this.interactivityHintEnabled=f,this.observer=g,this.viewMode=d,this.scale=p,this.container=m,this.assets=S,this.animate=!0===b&&s.a.get(this.custom,"animation.enabled",!0),n.view&&n.view.infographic&&(this.infographic=n.view.infographic),0===this.colors.length&&n.getTypeMod()!==O.TABLE&&(this.colors=this.themeColors.slice(0))},initializeData:function(e){e.forEach((function(t,a){t&&t.length||(t=e[a]=[[]]),s.a.isArray(t[0])||(t[0]=[])})),this.data=e},setupChartOptions:function(){var e=this.animate,t=this.chart,a=this.charts,i=this.custom,r=this.displayTabs,o=this.instanceClass,c=this.freeLayout,l=this.container,h=this.chartOptions=o.prototype.defaults();h.sheetnames=t.get("sheetnames"),h.sheetOptions=this.setupChartSheetOptions(),h.container=l,h.fixedHeight=c,h.scale={x:s.a.get(this,"scale.x",1),y:s.a.get(this,"scale.y",1)},this.setupChartOptionsDimensions(),s.a.set(h,"tooltip.enabled",s.a.get(i,"tooltip.enabled",!0)),"download"===this.viewMode&&s.a.set(h,"tooltip.enabled",!1);var f=(s.a.get(i,"showSheetPlayer")?"player":r&&"tab")||"radio";s.a.set(h,"sheetSwitch.enabled",!0),s.a.set(h,"sheetSwitch.type",f),s.a.merge(h.sheetSwitch.tabOptions,s.a.get(a,"sheetSwitch.tabOptions",{})),s.a.has(i,"shrink")&&i.shrink>0&&(h.width=u.default.chartWidth(i.shrink),h.container.style.width="".concat(h.width,"px")),h.downloadText=s.a.get(i,"showDownload")&&(n.default.t("table.download_data")||"Download data"),h.aggregateData=s.a.get(i,"aggregateData",!1),h.accumulateValues=s.a.get(i,"accumulateValues",!1),s.a.set(h,"sheetSwitch.tabOptions.enabled",!s.a.get(i,"hideTabs",!1)),e||s.a.set(h,"animation.duration",0)},setupChartSheetOptions:function(){var e=this.sheetSettings,t=this.custom;t&&s.a.has(t,"colors")&&delete t.colors;var a=s.a.omit(t,"map_json"),n=e&&e.length,i=[this.setupChartSheetOptionsItem(s.a.merge({},a))];if(n)for(var r=0;r<n;r++){var o=s.a.merge({},a,e[r]);i.push(this.setupChartSheetOptionsItem(o,r))}return i},sheetOptionsItemDefaults:function(e){var t=this.getGridSettings(e),a=t.vertical,n=t.horizontal,i=this.getZeroBaseline(e),r=i.verticalZero,o=i.horizontalZero,c={categories:{colors:s.a.merge([],this.themeColors,e.colors||this.colors)},series:[{}],grid:{vertical:a,horizontal:n,verticalZero:r,horizontalZero:o},axis:[{},{}]};return this.setupLegend(c,e),c},setupChartSheetOptionsItem:function(e){return{categories:{colors:s.a.merge([],this.themeColors,e.colors||this.colors)},grid:{},axis:[{}]}},setupLegend:function(e,t){e.legend={enabled:!1!==t.showLabels,position:s.a.get(t,"labels.legend.position",s.a.get(this,"charts.legend.position","bottom")),align:s.a.get(t,"labels.legend.align",s.a.get(this,"charts.legend.align","top")),layouts:s.a.get(this,"charts.legend.layouts",{})}},addPx:function(e){return e+(/px/.test(e)?"":"px")},getGridSettings:function(e){var t=s.a.get(e,"axis.x.grid"),a=s.a.get(e,"axis.y.grid");if(void 0===t&&void 0===a){var n=!1!==e.grid;t=n,a=n}return{vertical:t,horizontal:a}},getGridSettingsHorizontal:function(e){var t=s.a.get(e,"axis.y.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getGridSettingsVertical:function(e){var t=s.a.get(e,"axis.x.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getZeroBaseline:function(e){return{verticalZero:this.getZeroBaselineVertical(e),horizontalZero:this.getZeroBaselineHorizontal(e)}},getZeroBaselineVertical:function(e){return s.a.get(e,"axis.x.zeroBaseline",!0)},getZeroBaselineHorizontal:function(e){return s.a.get(e,"axis.y.zeroBaseline",!0)},assignAxisInverse:function(e,t,a){var n=["y","y2"].indexOf(a)+1;s.a.set(e,"axis[".concat(n,"].invert"),s.a.get(t,"axis.".concat(a,".invert"),!1))},assignTrendline:function(e,t){var a=s.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{}),n=s.a.get(a,"text","#464646");s.a.set(e,"categories.trendline.enabled",s.a.get(t,"trendline.enabled",!1)),s.a.set(e,"categories.trendline.color",s.a.get(t,"trendline.color",n))},setupChartOptionsStyle:function(){var e=this,t=s.a.get(this,"custom.textColor"),a=this.chartOptions,n=s.a.merge({},this.themeFont.common||{},this.themeFont.label||{}),i=s.a.merge({},this.themeFont.common||{},this.themeFont.legend||{}),o=s.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{});t&&(o.text=t),a.style.grid.color=Object(c.gridColor)(this.custom,{charts:this.charts,color:this.themeStyleColor}),a.style.grid.opacity=s.a.get(this,"custom.axis.alpha",s.a.get(this,"charts.grid.alpha",.5)),s.a.set(a,"style.graph.item.outline.color",t||o.text),s.a.set(a,"style.graph.item.outline.width","1px"),["x","y","y2"].forEach((function(t){a.style.axis[t].tick["font-family"]=s.a.get(e,"custom.labels.axis.".concat(t,".tick.font-family"),n.fontFamily),a.style.axis[t].tick["font-size"]=e.addPx(n.fontSize),a.style.axis[t].tick["font-weight"]=n.fontWeight,a.style.axis[t].tick["font-style"]=n.fontStyle,a.style.axis[t].tick.color=o.text,a.style.axis[t].title["font-family"]=s.a.get(e,"custom.labels.axis.".concat(t,".title.font-family"),n.fontFamily),a.style.axis[t].title.color=o.text})),["name","value"].forEach((function(t){a.style.graph.item[t]["font-family"]=s.a.get(e,"custom.labels.graph.item.value.font-family",n.fontFamily),a.style.graph.item[t]["font-size"]=e.addPx(n.fontSize),a.style.graph.item[t]["font-weight"]=n.fontWeight,a.style.graph.item[t]["font-style"]=n.fontStyle,"name"===t&&(a.style.graph.item[t].color=o.text)})),s.a.has(a.style,"graph.item.value.color.contrast")&&s.a.set(a.style,"graph.item.value.color.contrast.background",this.getChartBackgroundColor());var l=["fontSize","fontFamily","fontWeight","fontStyle"];s.a.merge(a.style.sheetSwitch,s.a.omit(s.a.get(this,"charts.sheetSwitch.style",{}),l.map((function(e){return"tab.".concat(e)}))),{}),l.forEach((function(t){s.a.has(e,"charts.sheetSwitch.style.tab.".concat(t))&&s.a.set(a.style.sheetSwitch,"tab.".concat(s.a.kebabCase(t)),s.a.get(e,"charts.sheetSwitch.style.tab.".concat(t)))})),a.style.sheetSwitch.tab["font-family"]=s.a.get(this,"custom.labels.sheetSwitch.tab.font-family")||s.a.get(this,"charts.sheetSwitch.style.tab.fontFamily",n.fontFamily),a.style.sheetSwitch.radio["font-family"]=a.style.sheetSwitch.tab.fontFamily;var h={text:{}};["fontFamily","fontSize","fontWeight"].forEach((function(e){s.a.has(a.style.sheetSwitch.tab,e)&&(h.text[s.a.kebabCase(e)]=a.style.sheetSwitch.tab[e])}));var u=s.a.get(this,"charts.sheetSwitch.style.tab.colors.tab.background");u&&s.a.set(h,"colors.background",u);var f=s.a.get(this,"charts.sheetSwitch.style.tab.color");if(f&&s.a.set(h,"colors.foreground",f),t){var d=a.style.sheetSwitch.tab;d.color=t,d.colors.dropdown.selectIcon=t,d.colors.dropdown.leftSwitcherIcon=t,d.colors.dropdown.rightSwitcherIcon=t}s.a.merge(a.style.hint,h),a.style.legend["font-family"]=s.a.get(this,"custom.labels.legend.font-family",i.fontFamily),a.style.legend["font-size"]=this.addPx(i.fontSize),a.style.legend["font-weight"]=i.fontWeight,a.style.legend["font-style"]=i.fontStyle,s.a.merge(a.style.legend.color,s.a.get(this,"charts.legend.color",{}));var p=s.a.get(this,"custom.labels.legend.color");if(!p&&t&&(p=t),p){var g=Object(r.rgb)(p);g.opacity=.7,a.style.legend.color.label={active:p,hover:g.toString(),inactive:p}}a.style.fontFamily=s.a.get(this,"custom.fontFamily")},setupChartOptionsCustomStyle:function(){this.assignChartOptionsCustomStyle(["axis.x.tick","axis.y.tick","axis.y2.tick","axis.x.title","axis.y.title","axis.y2.title","graph.item.name","graph.item.value","legend","sheetSwitch.tab","tooltip.text","tooltip.value","regionNames"])},assignChartOptionsCustomStyle:function(e){var t=this.chart,a=this.custom,n=this.chartOptions,i=Object(c.defaultColorMethod)(t),r=["font-size","font-style","font-weight","color"],o=this.getChartBackgroundColor(),l=t.getTypeMod(),h=[O.PICTORIAL_SIZE,O.PICTORIAL_BAR];e.forEach((function(e){s.a.get(a,"labels.".concat(e))&&r.forEach((function(t){var r=s.a.get(a,"labels.".concat(e,".").concat(t));if("graph.item.value"===e&&"color"===t&&(!r||"string"==typeof r)){if(-1!==h.indexOf(l))return;return O.TREEMAP===l?void(r&&"string"==typeof r&&s.a.set(n.style,"".concat(e,".").concat(t),r)):void s.a.set(n.style,"".concat(e,".").concat(t),s.a.merge({contrast:{background:o}},Object(c.defaultColorValue)(r,i)))}if(r&&("legend"!==e||"color"!==t)){var u="color"===t&&"graph.item.value"===e&&"object"===k(r)?s.a.merge({contrast:{background:o}},r):s.a.cloneDeep(r);s.a.set(n.style,"".concat(e,".").concat(t),u)}}))}))},setupChartOptionsDimensions:function(){var e=this.custom,t=this.chartOptions;s.a.get(e,"height")?t.height=parseInt(e.height,10):t.height=this.defaultHeight},getChartBackgroundColor:function(){var e=s.a.get(this.themeStyleColor,"chart.bg","transparent");return"transparent"===e&&"transparent"===(e=s.a.get(this.themeStyleColor,"bg","transparent"))&&(e="#ffffff"),e},createInstance:(T=regeneratorRuntime.mark((function t(){var a,n,i,r,c,h=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=function(){a?(delete r.legendData,r.render()):Object(o.addRenderQueue)(r)},a=!1,n=this.chartOptions,this.cleanup(),i=this.getChartInstance(),this.chartOptions.height||(this.chartOptions.height=R(this.chart.getTypeMod())),(r=s.a.get(i,"instance"))?(a=!0,this.instance=r,r.mergeOptions(n)):(r=new this.instanceClass(n),this.instance=r),s.a.has(this.custom,"defaultTab")&&(r.sheetIndex=this.custom.defaultTab),void 0!==this.captureSheetIndex&&(r.sheetIndex=this.captureSheetIndex),l.default.create({chartType:C(this),chart:r,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport(),useAllColumns:this.custom.useAllColumns,disableColumnSheets:this.disableColumnSheets,assets:this.assets}).import(this.data),r.applySheetOptions(r.options.sheetOptions),p.default.subscribe(this),this.onSheetClick&&r.events.on("tabChanged.downloads",(function(e){h.onSheetClick.call(null,e,h.id)})),void 0!==this.sheetIndex&&(r.sheetIndex=this.sheetIndex,s.a.set(r,"options.sheetSwitch.enabled",!1)),r.loaded=e.Deferred(),r.events.on("endAnimation",(function(){r.loaded.resolve(),r.events.on("endAnimation",null),h.chart.getTypeMod()===O.MAP&&(!1!==s.a.get(r,"options.mobileInteractivityHint")?(h.interactivityHintEnabled=!0,r.interactivityHintText="Use two fingers to zoom or pinch map"):h.interactivityHintEnabled=!1),h.observer&&h.interactivityHintEnabled&&-1===_.indexOf(h.viewMode)&&h.observer.add(r.root.node(),(function(e){h.observer.getSmallerObjectVisibilityRatio(e)>.5?h.scheduleInteractivityHint(r):h.cancelInteractivityHint()}))})),r.events.on("downloadData",(function(){var e=r.sheetIndex,t=h.chart.get("data"),a=t[e]?e:0,n={data:t[a],title:h.chart.get("sheetnames")[a]||"data",firstCellContainsData:A.includes(h.chart.getTypeMod())};m.default.downloadData(n)})),this.chart.getTypeMod()===O.MAP&&r.events.on("storePosition",(function(){var e=r.map;e.resetZoom&&e.positionChanges&&delete e.resetZoom;var t=e.applyToAllSheets,a=[];if(t)for(var n=0,i=r.options.sheets.length;n<i;n++)a.push(n);else a.push(r.sheetIndex);var o=e.getBounds(),c={view:{bounds:[[o.getNorthWest().lat,o.getNorthWest().lng],[o.getSouthEast().lat,o.getSouthEast().lng]]}};e.resetZoom&&(c.view=null,delete e.resetZoom);var l=h.chart;a.forEach((function(e){r.options.sheetOptions[e]=s.a.merge({},r.options.sheetOptions[e],{view:c.view}),r.options.sheets[e]=s.a.merge({},r.options.sheets[e],{view:c.view}),Object(g.default)({chart:l,sheetIndex:e}).setCustom(c),t||Object(b.buildXHR)({sheetIndex:e,chart:l}).setCustom(c).send()})),t&&Object(b.buildXHR)({chart:l,applyToAllSheets:"view"}).setCustom(c).send(),Object(d.default)(l)})),r.events.on("interaction",(function(e){!h.freeLayout&&"preview"===h.viewMode&&"link"===e.location&&"click"===e.type&&s.a.get(e,"params.value")&&(window.open(e.params.value).opener=null);var t=h.id;"number"==typeof h.id&&(t="c_".concat(h.id)),Object(y.engagementEvent)(t,e.location,e.type),h.interactedWith=!0})),this.freeLayout||"embed"!==this.viewMode&&"web"!==this.viewMode?this.delayedRender=s.a.delay(c,this.delayVisualInitialization):this.delayedRender=requestAnimationFrame(c),t.abrupt("return",this);case 22:case"end":return t.stop()}}),t,this)})),N=function(){var e=this,t=arguments;return new Promise((function(a,n){var i=T.apply(e,t);function s(e){S(i,a,n,s,r,"next",e)}function r(e){S(i,a,n,s,r,"throw",e)}s(void 0)}))},function(){return N.apply(this,arguments)}),resize:function(e,t){var a=this.instance;a.options.width=e,t&&(a.options.height=t),Object(o.addRenderQueue)(a)},getDecimalSeparator:function(){var e=-1!==D.indexOf(this.custom.decimalSeparator),t=D[0],a=[];e&&(t=this.custom.decimalSeparator);var n=this.infographic&&this.infographic.get("properties")&&this.infographic.get("properties").decimal_separator;return!e&&n&&(t=n),s.a.has(this,"custom.dataInputFormat.decimalSeparator")&&(t=s.a.get(this,"custom.dataInputFormat.decimalSeparator")),a.push(t),this.sheetSettings&&(a=a.concat(this.sheetSettings.map((function(e){return e&&e.decimalSeparator||null})))),a},transposeImport:function(){return this.custom.switchRowsColumns},updateData:function(e){var t=this.instance;t&&(l.default.create({chartType:C(this),chart:t,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport(),assets:this.assets}).import(e),t.applySheetOptions(t.options.sheetOptions),t.render())},assignCategoryLabelLayout:function(e,t){"tilted"===t.categoryLayout&&(e.layout="tilted")},assignNumberFormatValues:function(e){var t=this,a=e.sheetOptions,n=e.custom,i=e.axis,r={x:0,y:1,y2:2};i.forEach((function(e){var i=e.id,o=e.path,c=o?s.a.get(n,o,{}):n,l=a.axis[r[i]];s.a.has(l,"format")||s.a.set(l,"format",{});var u=l.format;if(I(u,c),s.a.has(t,"custom.dataInputFormat.decimalSeparator")){var f=s.a.get(t,"custom.dataInputFormat.decimalSeparator");s.a.set(u,"numberParser",new h.default("firstNumber",f))}var d=["useSIPrefixes"];s.a.get(n,"axis.".concat(i,".affix"),!0)&&d.push("prefix","suffix"),d.forEach((function(e){var t=s.a.get(c,e);void 0!==t&&s.a.set(u,e,t)}))}))},assignNumberFormatLabels:function(e){var t=this,a=e.sheetOptions,n=e.custom,i=e.affixes,r={label:{libraryTargetPath:"labels.format",customAffixPath:"labels.graph.item.format.affix"},x:{libraryTargetPath:"tooltip.format.x",customAffixPath:"labels.tooltip.format.x.affix"},y:{libraryTargetPath:"tooltip.format.y",customAffixPath:"labels.tooltip.format.y.affix"},y2:{libraryTargetPath:"tooltip.format.y2",customAffixPath:"labels.tooltip.format.y2.affix"}};(void 0===i?[]:i).forEach((function(e){var i=e.id,o=e.path,c=e.ignoreCheck,l=e.defaultValue,u=r[i],f=u.libraryTargetPath,d=u.customAffixPath,p=o?s.a.get(n,o,{}):n,g=s.a.pick(p,"prefix","suffix");if(I(g,p),s.a.has(t,"custom.dataInputFormat.decimalSeparator")){var m=s.a.get(t,"custom.dataInputFormat.decimalSeparator");s.a.set(g,"numberParser",new h.default("firstNumber",m))}c||s.a.get(n,d,l)||(s.a.unset(g,"prefix"),s.a.unset(g,"suffix")),s.a.set(a,f,g)}))},assignAxisTicks:function(e,t){var a=e.axis,n=["x","y","y2"];a.forEach((function(e,a){e.ticks=s.a.get(t,"labels.axis.".concat(n[a],".tick.enabled"),!0)}))},assignAxisTickInterval:function(e,t){var a=e.axis,n=["x","y","y2"];a.forEach((function(e,a){var i=s.a.get(t,"axis.".concat(n[a],".ticks"));void 0!==i&&(e.tickInterval=i)}))},scheduleInteractivityHint:function(e){var t=this;this.interactedWith||this.interactivityHintDelay||(this.interactivityHintDelay=setTimeout((function(){t.interactedWith||(e.interactionHint(),t.interactedWith=!0,t.interactivityHintDelay=null)}),3e3))},cancelInteractivityHint:function(){this.interactivityHintDelay&&(clearTimeout(this.interactivityHintDelay),this.interactivityHintDelay=null)},getChartInstance:function(){return x.default.getEntity(this.id)},cleanup:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),this.loadingShapes&&(this.loadingShapes.abort(),this.loadingShapes=void 0),e&&(this.observer&&this.observer.remove(e.container.node()),this.cleanUpSheetPlayer(),this.instanceClass.getClassName()!==e.getClassName()&&w(t,e.container.node()))},remove:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),e&&(this.cleanUpSheetPlayer(),w(t,e.container.node()))},cleanUpSheetPlayer:function(){var e=this.getChartInstance(),t=s.a.get(e,"instance.sheetPlayer");t&&t.remove()}}}.call(this,a("+hRF"))},Fbx7:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return r}));var n=a("LvDl"),i=a.n(n),s=a("Z8Pq");function r(e){var t=e.options,a=e.emptySheet,n=e.createNumberParser;return{default:Object(s.createImportFn)((function(r,o){var c=i.a.merge({},a),l=r[0]||[],h=i.a.get(t,"sheetnames[".concat(o,"]")),u=n.call(e,o+1),f=t.accumulateValues,d=i.a.merge({},c.series[0]);c.series=[],c.categories.title=Object(s.replaceBlank)(h||l[0]);for(var p=r.length,g=Object(s.getMaxColCount)(r),m=[],v=1;v<g;v++){for(var b=i.a.merge({data:[]},d),y=1;y<p;y++){var x=r[y],O=x[0];if(!Object(s.isBlank)(x[v])||f&&void 0!==m[y]){var S=u(x[v]);if(f){if(S=Number(S),isNaN(S))continue;S+=m[x]||0,m[x]=S,S=S.toString()}b.data.push({y:O,x:S,colorIndex:y-1}),b.min=Math.min(+b.min||0,+S),b.max=Math.max(+b.max||0,+S)}}b.label=Object(s.replaceBlank)(l[v]),c.series.push(b)}t.sheets.push(c)})),transposed:Object(s.createImportFn)((function(r,o){var c=t.accumulateValues,l=i.a.merge({},a),h=r[0]||[],u=i.a.get(t,"sheetnames[".concat(o,"]")),f=n.call(e,o+1),d=i.a.merge({},l.series[0]);l.series=[],l.categories.title=Object(s.replaceBlank)(u||h[0]);for(var p=r.length,g=Object(s.getMaxColCount)(r),m=[],v=1;v<p;v++){for(var b=r[v],y=i.a.merge({data:[]},d),x=1;x<g;x++){var O=b[x],S=h[x];if(!Object(s.isBlank)(O)||c&&void 0!==m[x]){var k=f(O);if(c&&v>1){if(k=Number(k),isNaN(k))continue;k+=m[x]||0,m[x]=k,k=k.toString()}y.data.push({y:S,x:k,colorIndex:x-1}),y.min=Math.min(+y.min||0,+k),y.max=Math.max(+y.max||0,+k)}}y.label=Object(s.replaceBlank)(b[0]),l.series.push(y)}t.sheets.push(l)}))}}},JnWj:function(e,t,a){"use strict";a.r(t);var n={firstNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",a=1;function n(e){return e<0?"-":""}if("string"==typeof(e=i(e))){var s=[],r=e.search(/\d/),o=r-1,c=e.indexOf(t);if(-1===c&&(c=e.length),c<r){if(e[o]===t){var l=e.slice(o,e.length),h=l.split(/(\d+)/);return h[0]===t&&h[1]&&s.push("0.".concat(h[1])),"-"===e[c-1]&&(a=-1),"".concat(n(a)).concat(i(s.join("")))}c=e.length}"-"===e[o]&&(a=-1);for(var u,f=e.slice(r,c),d=1,p=/^[\\., ]$/,g=f.split(/(\d+)/),m=g.length;d<m;d++){var v=g[d],b=/\d/.test(v);if(b)if(1===d){if(s.push(v),v.length>3)break}else{if(3!==v.length)break;s.push(v)}else{if(!p.test(v))break;if(u||(u=v),u!==v)break}}if(s.join(" ").length===f.length){var y=e.slice(c,e.length),x=y.split(/(\d+)/);x[0]===t&&x[1]&&s.push("."+x[1])}e=i(s.join(""))}return"".concat(n(a)).concat(e)},legacy:function(e){var t="";return"string"==typeof e&&(t="-"===e[0]?e[0]:"",-1!==e.indexOf(",")&&(e=e.replace(/,/g,".")),e=(e=e.replace(/\.(?![^.]+$)/g,"")).replace(/[^0-9\.]/g,"")),""===e?"undefined":"".concat(t).concat(i(e))}};function i(e){if(""!==e)return e}t.default=function(e,t){return function(e,t){return function(a){return e(a,t)}}(n[e]||n.firstNumber,t=","===t?",":".")}},LU9w:function(e,t,a){"use strict";a.r(t),a.d(t,"ENGAGEMENT_EVENT",(function(){return n})),a.d(t,"ENGAGEMENT_INSCREEN",(function(){return i}));var n="ENGAGEMENT_EVENT",i="ENGAGEMENT_INSCREEN"},Oq5T:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return h}));var n=a("LvDl"),i=a.n(n),s=a("zxw/");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=/\[([^\]]*)\]\((https?:\/\/[^\)]*)\)/gi,c=["background-color","color","font-size","font-style","font-weight","text-align","text-decoration","vertical-align"],l=function(e){if("link"===e.type){var t=function(e){return-1===e.indexOf("mailto:")?"_blank":"_self"}(e.href),a=i.a.escape(e.href),n=(e.value||"").replace(/\</g,"&lt;");return{href:a,value:n,target:t,text:n.toLowerCase()}}if(e.value||""===e.value){var s=e.value.toString().replace(/\</g,"&lt;");return{text:s.toLowerCase(),value:s}}for(var r,c=e=e.toString().replace(/\</g,"&lt;");null!==(r=o.exec(e));)r&&r[1]&&r[2]&&(e=e.replace(r[0],"<a href='".concat(r[2],"' target='_blank'>").concat(r[1],"</a>")),c=c.replace(r[0],r[1]));return o.lastIndex=0,{text:c.toLowerCase(),value:e}};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.assets,n=t.className,o=t.pathInsteadOfText,h=void 0!==o&&o,u={value:"",className:n};if(null==e)return u;"object"===r(e)&&Object.keys(e).forEach((function(t){-1!==c.indexOf(t)&&(u[t]=e[t])}));var f=i.a.get(e,"value",e);""!==f&&h&&"igc-table-header"!==n&&(u.shape=h,u.tooltip=f);var d=a&&s.IMG_ASSET_ID.exec(f);return d&&a.getURL(d[1])?(u.img=a.getURL(d[1]),u.tooltip="",i.a.merge(u,l(e))):(s.IMG.lastIndex=0,(d=s.IMG.exec(f))?(u.img=d[1],u.tooltip=""):(s.SVG.lastIndex=0,(d=s.SVG.exec(f))&&(u.shape=d[1],u.tooltip="")),i.a.merge(u,l(e)))}},PZzD:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return o}));var n=a("LvDl"),i=a.n(n),s=a("Z8Pq");function r(e,t){return i.a.get(e,"sheetOptions[".concat(t,"].series[0].parseFormat.x"))}function o(e){var t=e.options,a=e.emptySheet;return{default:Object(s.createImportFn)((function(n,o){var c=i.a.merge({},a),l=n[0]||[],h=t.sheetnames&&t.sheetnames[o],u=function(e){return e};"number"===(r(t,o+1)||r(t,0))&&(u=e.createNumberParser(o+1));var f=i.a.merge({},c.series[0]);c.series=[f],f.data=[],f.rawData=[],f.links=[],c.categories.data||(c.categories.data=[]),c.categories.title=Object(s.replaceBlank)(h||l[0]),n.forEach((function(e,t){if(0!==t){var a,n=[];e.forEach((function(e){var t=Object(s.extractCell)(e);t.link&&!a&&(a=t.link),n.push(t.value)})),c.categories.data.push(n[0]);var i={x:u(n[1]),x2:u(n[2]),label:n[3]};f.data.push(i),f.rawData.push(i),f.links.push(a)}})),t.sheets.push(c)})),transposed:Object(s.createImportFn)((function(e,n){var r=i.a.merge({},a),o=i.a.merge({},r.series[0]);r.series=[o],o.data=[],o.rawData=[],o.links=[];var c=e[0]&&e[0].map((function(e){return Object(s.replaceBlank)(e,"",!0)}))||[],l=i.a.get(t,"sheetnames[".concat(n,"]")),h=Object(s.getMaxColCount)(e);r.categories.data||(r.categories.data=[]),r.categories.title=l||Object(s.replaceBlank)(i.a.get(c,"[0]"),"",!0);for(var u=1;u<h;u++){for(var f=void 0,d=[],p=0;p<4;p++){var g=i.a.get(e,"[".concat(p,"][").concat(u,"]")),m=Object(s.extractCell)(g);m.link&&!f&&(f=m.link),d.push(m.value)}r.categories.data.push(d[0]);var v={x:d[1],x2:d[2],label:d[3]};o.data.push(v),o.rawData.push(v),o.links.push(f)}t.sheets.push(r)}))}}},PiB6:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return r}));var n=a("LvDl"),i=a.n(n),s=a("Z8Pq");function r(e){var t=e.options,a=e.emptySheet,n=e.createNumberParser;return{default:Object(s.createImportFn)((function(r,o){var c=i.a.merge({},a),l=r[0]||[],h=i.a.get(t,"sheetnames[".concat(o,"]")),u=n.call(e,o+1),f=i.a.merge({},c.series[0]);c.series=[f],f.data=[],f.rawData=[],f.links=[],c.categories.data=l.slice(1,5),c.categories.title=Object(s.replaceBlank)(h||l[0]);for(var d=function(e){var t=r[e];if(t.length<5)return"continue";var a=void 0,n=[];t.forEach((function(e){var t=Object(s.extractCell)(e);t.link&&!a&&(a=t.link),n.push(t.value)}));var i=u(n[1]),o=u(n[2]),c=u(n[3]),l=u(n[4]);if(isNaN(i)||isNaN(o)||isNaN(c)||isNaN(l))return"continue";var h=[n[0],i,o,c,l];f.data.push(h),f.rawData.push(n.slice(0)),f.links.push(a)},p=1;p<r.length;p++)d(p);t.sheets.push(c)})),transposed:Object(s.createImportFn)((function(r,o){var c=i.a.merge({},a),l=n.call(e,o+1),h=i.a.merge({},c.series[0]);c.series=[h],h.data=[],h.rawData=[],h.links=[];var u=r[0]&&r[0].map((function(e){return Object(s.replaceBlank)(e,"",!0)}))||[],f=i.a.get(t,"sheetnames[".concat(o,"]")),d=Object(s.getMaxColCount)(r);c.categories.title=f||Object(s.replaceBlank)(i.a.get(u,"[0]"),"",!0),c.categories.data=[];for(var p=1;p<5;p++){var g=i.a.get(r,"[".concat(p,"][0]")),m=Object(s.extractCell)(g);c.categories.data.push(m.value)}for(var v=1;v<d;v++){for(var b=void 0,y=[],x=0;x<5;x++){var O=i.a.get(r,"[".concat(x,"][").concat(v,"]")),S=Object(s.extractCell)(O);S.link&&!b&&(b=S.link),y.push(S.value)}var k=l(y[1]),w=l(y[2]),C=l(y[3]),I=l(y[4]);if(!(isNaN(k)||isNaN(w)||isNaN(C)||isNaN(I))){var j=[y[0],k,w,C,I];h.data.push(j),h.rawData.push(j),h.links.push(b)}}t.sheets.push(c)}))}}},S99L:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),s=["=","@","+"],r={convertDataToCSV:function(e){var t=/\"/g,a="\ufeff";return e.forEach((function(e){a+=e.map((function(e){return i.a.has(e,"value")&&(e=e.value),null===e&&(e=""),e=e.toString().replace(t,'""').replace("\n",""),-1!==s.indexOf(e[0])&&(e="'".concat(e)),'"'.concat(e,'"')}))+"\n"})),a},forceDownloadOfContent:function(e,t){var a=new Blob([e],{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var n=window.URL.createObjectURL(a),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=n,i.download=t,i.click(),window.URL.revokeObjectURL(n),i.remove()}},downloadData:function(e){var t=e.data,a=e.title,n="".concat(a,".csv"),i=r.convertDataToCSV(t);"undefined"!=typeof ga&&ga("send","event","Download chart data"),r.forceDownloadOfContent(i,n)}};t.default=r},SdvQ:function(e,t,a){"use strict";a.r(t),a.d(t,"engagementEvent",(function(){return s})),a.d(t,"engagementInscreen",(function(){return r}));var n=a("Zcty"),i=a("LU9w"),s=function(e,t,a){n.default.dispatch({type:i.ENGAGEMENT_EVENT,objectId:e,eventType:t,action:a})},r=function(){n.default.dispatch({type:i.ENGAGEMENT_INSCREEN})}},Z8Pq:function(e,t,a){"use strict";a.r(t),a.d(t,"isBlank",(function(){return s})),a.d(t,"replaceBlank",(function(){return r})),a.d(t,"getMaxColCount",(function(){return o})),a.d(t,"fillSheets",(function(){return c})),a.d(t,"spreadSheets",(function(){return h})),a.d(t,"extractCell",(function(){return u})),a.d(t,"createImportFn",(function(){return f})),a.d(t,"getRowValuesAndLink",(function(){return d})),a.d(t,"categoryHelper",(function(){return p})),a.d(t,"seriesHelper",(function(){return g})),a.d(t,"isSeriesDataValid",(function(){return m})),a.d(t,"cleanSheetSeries",(function(){return v})),a.d(t,"isValidColor",(function(){return b})),a.d(t,"validDataMaxLimit",(function(){return y})),a.d(t,"limitSheetData",(function(){return x}));var n=a("LvDl"),i=a.n(n);function s(e){return"number"==typeof e&&isNaN(e)||null==e||""===e}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s(e)?t:a&&e.value?e.value:e}function o(e){return i.a.reduce(e,(function(e,t){return Math.max(e,t.length)}),0)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.forEach((function(e){e.length||(e=[[]]);var n=a;e.forEach((function(e){e&&e.length>n&&(n=e.length)}));for(var s=Math.max(e.length,t),r=0;r<s;r++){e[r]||(e[r]=[]);for(var o=0;o<n;o++)i.a.isUndefined(e[r][o])&&(e[r][o]="")}})),e}function l(e){var t=[];return e.forEach((function(e,a){e.length<2&&0===a&&(e=[e[0]||"",""]),e.forEach((function(a,n){if(n>0){var i=n-1;(t[i]?t[i]:t[i]=[]).push([e[0],a])}}))})),t}function h(e,t){if(e.length<2)return l(e[0]);if(t){var a=[];return e.forEach((function(e){l(e).forEach((function(e){a.push(e)}))})),a}return e}function u(e){var t={};return i.a.isPlainObject(e)?(i.a.has(e,"value")&&(t.value=e.value),"link"===i.a.get(e,"type")&&(t.link=e.href),t):(t.value=e,t)}function f(e){return function(t){t.forEach(e)}}function d(e,t){var a={row:[]};return e.forEach((function(e,n){var i=t(e);i.link&&(a.link=i.link),a.row[n]=i.value})),a}function p(e){return function(t){var a=e.categories.data,n=a.indexOf(t);return-1===n&&(n=a.length,a.push(t)),n}}function g(e,t){return function(a,n){var s=e.series[a];return s||((s=e.series[a]=i.a.merge({},t)).index=void 0!==n?n:a,s.data=s.data||[],s.rawData=s.rawData||[],s.links=s.links||[]),s}}function m(e){return 0!==e.length&&i.a.some(e,(function(e){return!isNaN(e)}))}function v(e){var t=[];e.forEach((function(e,a){m(e.data)||t.push(a)})),function e(t,a){t.length&&(a.splice(t[0],1),t.shift(),function(e){e.forEach((function(t,a){e[a]=t-1}))}(t),e(t,a))}(t,e)}function b(e){if(!e||4!==e.length&&7!==e.length)return!1;return!!e.match(/^\#[0-9a-f]{6}$|^\#[0-9a-f]{3}$/gi)}function y(e,t){var a=0;return e.forEach((function(e){for(var n=e.data.length-1,i=n;i>=0;i--){var s=e.data[i];if(n=i,t(s))break}a=Math.max(a,n)})),a}function x(e,t){e.series.forEach((function(e){e.data.splice(t),e.rawData.splice(t),e.links.splice(t)})),e.categories.data.splice(t)}},ZBKM:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return c}));var n=a("Pp7T"),i=a.n(n),s=a("JPcv"),r=a("Zcty"),o=a("hl5+");function c(e,t,a){i()(s.Map.isMap(t),"External chart data should be immutable"),r.default.dispatch({type:o.EDITOR_SET_CHART_EXTERNAL_DATA,id:e,data:t,model:a})}},ibon:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),s=a("JnWj"),r=a("m6Yx"),o=a("PZzD"),c=a("PiB6"),l=a("474q"),h=a("Fbx7"),u=a("Z8Pq"),f=a("0Qba"),d=a("Oq5T"),p=a("pWQL");function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.emptySheet=t.chart.emptySheetData(),this.options=t.chart.options,this.transpose=t.transpose,this.useAllColumns=t.useAllColumns,this.decimalSeparators=[].concat(t.decimalSeparator),this.disableColumnSheets=t.disableColumnSheets,this.chartType=t.chartType,this.assets=t.assets}var t,a,n;return t=e,(a=[{key:"createNumberParser",value:function(e){var t=this.decimalSeparators,a=t[e]||t[0]||".",n=".,"===a?"legacy":"firstNumber";return new s.default(n,a)}},{key:"findImportFn",value:function(t){var a=e.IMPORT_TYPES[t];return this.transpose&&a.fnTranspose?a.fnTranspose:a.fn}},{key:"findImportType",value:function(t){for(var a in e.IMPORT_TYPES)if(-1!==e.IMPORT_TYPES[a].types.indexOf(t))return a}},{key:"import",value:function(e){if(e&&0!==e.length){var t=JSON.parse(JSON.stringify(e)),a=this.findImportType(this.chartType);this.options.aggregateData&&("multiSheet"===a&&(this.transpose=!this.transpose),t=function(e){return e.map((function(e){var t={};e.forEach((function(e){if(e.length>=2){var a=e[1],n=e[2]||" ",s=i.a.get(t,"[".concat(n,"][").concat(a,"]"),0);i.a.set(t,"[".concat(n,"][").concat(a,"]"),s+1)}}));var a=[[""]],n=Object.keys(t),s=[];return n.forEach((function(e,n){a[0][n+1]=e,Object.keys(t[e]).forEach((function(r){var o=s.indexOf(r)+1;o||(s.push(r),o=s.length,i.a.set(a,"[".concat(o,"][0]"),r)),a[o][n+1]=t[e][r]}))})),a}))}(t));var n=this.findImportFn(a);n&&(this.options.sheets=[],n.call(this,t))}}},{key:"singleSheetItem",value:function(e,t){var a=this.emptySheet,n=e.length,s=this.createNumberParser(t+1);if(0!==n)for(var r=this.useAllColumns?Object(u.getMaxColCount)(e):2,o=1;o<r;o++){var c=i.a.merge({},a),l=c.series[0],h=c.categories.data=[];c.categories.title=Object(u.replaceBlank)(e[0][o],"",!0),l.data=[],l.rawData=[],l.links=[];for(var f=1;f<n;f++){var d=e[f],p="".concat(Object(u.replaceBlank)(d[0],"",!0)),g=Object(u.extractCell)(d[o]);h.push(p);var m=Number(s(g.value));l.data.push(m),l.rawData.push(g.value),l.links.push(g.link)}Object(u.isSeriesDataValid)(l.data)&&this.options.sheets.push(c)}}},{key:"singleSheetItemTranspose",value:function(e,t){var a=this.emptySheet,n=e.length,s=Object(u.getMaxColCount)(e),r=this.createNumberParser(t+1);if(!(n<2))for(var o=this.useAllColumns?n:2,c=1;c<o;c++){var l=i.a.merge({},a),h=l.series[0],f=e[0].map((function(e){return Object(u.replaceBlank)(e,"",!0)})).slice(1);l.categories.title=Object(u.replaceBlank)(e[c][0]),h.data=[],h.rawData=[];var d=e[c];if(0!==d.length){for(var p=1;p<s;p++){var g=d[p];h.data.push(Number(r(g))),h.rawData.push(g)}l.categories.data=f,Object(u.isSeriesDataValid)(h.data)&&this.options.sheets.push(l)}}}},{key:"singleSheetItemOnly",value:function(e){for(var t=this.options,a=[],n=[],s=e[0]||[],r=e.length,o=this.disableColumnSheets?2:Object(u.getMaxColCount)(e),c=[],l=1;l<r;l++){var h=e[l];a.push("".concat(Object(u.replaceBlank)(h[0],"",!0)));for(var f=1;f<o;f++){var d=f-1,p=Object(u.extractCell)(h[f]),g=c[d],m=n[d];m||((m=n[d]=i.a.merge({},this.emptySheet)).categories.data=[],m.categories.title=Object(u.replaceBlank)(s[f],"",!0),m.series[0].index=d,m.series[0].data=[],m.series[0].rawData=[],m.series[0].links=[],g=c[d]=this.createNumberParser(f)),m.series[0].data.push(Number(g(p.value))),m.series[0].rawData.push(p.value),m.series[0].links.push(p.link)}}n.forEach((function(e){e.categories.data=a.slice(0)})),t.sheets=n.filter((function(e){return Object(u.isSeriesDataValid)(e.series[0].data)}))}},{key:"singleSheetItemOnlyTranspose",value:function(e){for(var t=this.options,a=(e[0]&&e[0].map((function(e){return Object(u.replaceBlank)(e,"",!0)}))||[]).slice(1),n=[],s=this.disableColumnSheets?2:e.length,r=Object(u.getMaxColCount)(e),o=[],c=1;c<s;c++){var l=c-1,h=e[c],f=o[l],d=n[l];if(0!==h.length){d||((d=n[l]=i.a.merge({},this.emptySheet)).categories.title=Object(u.replaceBlank)(h[0],"",!0),d.series[0].data=[],d.series[0].rawData=[],f=o[l]=this.createNumberParser(c),d.series[0].links=[]);for(var p=1;p<r;p++){var g=Object(u.extractCell)(h[p]);d.series[0].data.push(Number(f(g.value))),d.series[0].rawData.push(g.value),d.series[0].links.push(g.link)}d.categories.data=a}}t.sheets=n.filter((function(e){return Object(u.isSeriesDataValid)(e.series[0].data)}))}},{key:"multiSheetItemTranspose",value:function(e,t){var a=this.options,n=this.emptySheet,s=i.a.merge({},n),r=s.series.pop(),o=e.length,c=a.sheetnames&&a.sheetnames[t],l=this.createNumberParser(t+1),h=0,f=a.accumulateValues;if(0!==o){var d=e[0].map((function(e){return Object(u.replaceBlank)(e,"",!0)}));s.categories.title=Object(u.replaceBlank)(c||d[0]),s.categories.data=d.slice(1);for(var p=1;p<o;p++){var g=e[p],m=g.length;if(m){var v=Object(u.extractCell)(g[0]),b=i.a.merge({},r,{title:"".concat(Object(u.replaceBlank)(v.value,"",!0)),index:p-1,data:[],rawData:[],links:[],titleLink:v.link});h=Math.max(h,m-1),b.titleLink=v.link;for(var y=1;y<m;y++){var x=Object(u.extractCell)(g[y]),O=Number(l(x.value)),S=x.value,k=b.data[b.data.length-1];!f||isNaN(k)&&isNaN(O)||(isNaN(O)&&(O=0),isNaN(k)||(O+=k),S=O),b.data.push(O),b.rawData.push(S),b.links.push(x.link)}Object(u.isSeriesDataValid)(b.data)&&s.series.push(b)}}for(var w=0;w<h;w++)s.categories.data[w]=Object(u.replaceBlank)(s.categories.data[w]);a.sheets.push(s)}else a.sheets.push(i.a.merge(s,{categories:{title:"",data:[]},series:[i.a.merge(r,{data:[],rawData:[]})]}))}},{key:"multiSheetItem",value:function(e,t){var a=this.options,n=i.a.merge({},this.emptySheet),s=n.series.pop(),r=e.length,o=a.sheetnames&&a.sheetnames[t],c=this.createNumberParser(t+1),l=a.accumulateValues;if(0!==r){var h=Object(u.getMaxColCount)(e),f=e[0].map((function(e){return Object(u.replaceBlank)(e,"")})),d=Object(u.extractCell)(f.shift()).value,p=[],g=[];f.forEach((function(e,t){var a=Object(u.extractCell)(e);p[t]=a.link,g[t]=a.value}));var m=function(e,t){var a;a=n.series[e]?n.series[e]:n.series[e]=i.a.merge({},s,{title:"".concat(Object(u.replaceBlank)(g[e])),data:[],index:e,rawData:[],links:[]});var r=Number(c(t.value)),o=t.value,h=a.data[a.data.length-1];!l||isNaN(h)&&isNaN(r)||(isNaN(r)&&(r=0),isNaN(h)||(r+=h),o=r),a.data.push(r),a.rawData.push(o),a.links.push(t.link),a.titleLink=p[e]};n.categories.title=Object(u.replaceBlank)(o||d),n.categories.data=[];for(var v=1;v<r;v++){var b=e[v],y=b.length,x=Object(u.replaceBlank)(b[0],"");if(i.a.has(x,"value")&&(x=x.value),y){n.categories.data.push(x);for(var O=1;O<h;O++)m(O-1,Object(u.extractCell)(b[O]))}}Object(u.cleanSheetSeries)(n.series),a.sheets.push(n)}else a.sheets.push(i.a.merge(n,{categories:{title:"",data:[]},series:[i.a.merge(s,{data:[],rawData:[]})]}))}},{key:"doubleAxisSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,s=n.sheetnames&&n.sheetnames[t],r=this.createNumberParser(t+1);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.series[1].links||(a.series[1].links=[]),e.forEach((function(e,t){if(0===t)a.categories.title=Object(u.replaceBlank)(s||e[0]),a.axis[1].title=Object(u.replaceBlank)(e[1],"",!0),a.axis[2].title=Object(u.replaceBlank)(e[2],"",!0),a.axis[1].ticks=a.axis[2].ticks=!0,a.series[0].title=Object(u.replaceBlank)(e[1],"",!0),a.series[1].title=Object(u.replaceBlank)(e[2],"",!0);else{var n=Object(u.replaceBlank)(e[0],"",!0);if(Object(u.isBlank)(n))return;for(var i=[],o=1;o<3;o++){var c=Object(u.extractCell)(e[o]);c.link&&(i[o-1]=c.link),e[o]=c.value}a.categories.data.push("".concat(n)),a.series[0].data.push(Number(r(e[1]))),a.series[0].rawData.push(e[1]),a.series[1].data.push(Number(r(e[2]))),a.series[1].rawData.push(e[2]),a.series[0].index=0,a.series[1].index=1,a.series[0].links.push(i[0]),a.series[1].links.push(i[1])}})),Object(u.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"doubleAxisSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=e[0]&&e[0].map((function(e){return Object(u.replaceBlank)(e,"",!0)}))||[],s=Object(u.getMaxColCount)(e),r=this.options,o=r.sheetnames&&r.sheetnames[t],c=this.createNumberParser(t+1);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.categories.data=n.slice(1),a.categories.title=Object(u.replaceBlank)(o||n[0]),a.axis[1].ticks=a.axis[2].ticks=!0;for(var l=0;l<2;l++){var h=e[l+1];a.axis[l+1].title=Object(u.replaceBlank)(h[0],"",!0),a.series[l].title=Object(u.replaceBlank)(h[0],"",!0),a.series[l].index=l;for(var f=1;f<s;f++){var d=Object(u.extractCell)(h[f]);a.series[l].links.push(d.link),a.series[l].data.push(Number(c(d.value))),a.series[l].rawData.push(d.value)}}this.options.sheets.push(a)}},{key:"comboSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,s=i.a.merge({},a.series[0]),r=e[0]||[],o=n.sheetnames&&n.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.getMaxColCount)(e);a.series=[],a.categories.data||(a.categories.data=[]);var h=Object(u.seriesHelper)(a,s);r&&(a.categories.title=Object(u.replaceBlank)(o||Object(u.extractCell)(r[0]).value));var f=i.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));f&&!0===f.ticks&&l<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach((function(e,t){if(0!==t){a.categories.data.push(Object(u.replaceBlank)(Object(u.extractCell)(e[0]).value));for(var n=1;n<l;n++){var i=Object(u.extractCell)(e[n]),s=i.value,o=i.link,f=h(n-1);if(1===t&&!f.title&&r[n]){var d=Object(u.extractCell)(r[n]),p=d.value,g=d.link;f.title=Object(u.replaceBlank)(p),f.titleLink=g}f.data.push(Number(c(s))),f.rawData.push(s),f.links.push(o)}}}));var d=Object(u.validDataMaxLimit)(a.series,(function(e){return!isNaN(e)}));d=Math.max(d,Object(u.validDataMaxLimit)([a.categories],(function(e){return!Object(u.isBlank)(e)})))+1,Object(u.limitSheetData)(a,d),Object(u.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"FactsAndFiguresItem",value:function(e,t){var a=this.options,n=i.a.merge({},this.emptySheet),s=e.length,r=a.sheetnames&&a.sheetnames[t]||"Sheet ".concat(t+1);0!==s?(n.categories.data=[],n.categories.title=Object(u.replaceBlank)(r),e.forEach((function(e){if(e.length){var t=f.default.shapes[e[2]];n.categories.data.push({color:Object(u.isValidColor)(e[4])&&e[4]||"",figure:Object(u.extractCell)(e[0]).value,fact:Object(u.extractCell)(e[1]||"").value,shape:t})}})),a.sheets.push(n)):a.sheets.push(i.a.merge(n,{categories:{title:"",data:[]}}))}},{key:"comboSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=i.a.merge({},a.series[0]),s=this.options,r=e[0]||[],o=s.sheetnames&&s.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.getMaxColCount)(e);a.series=[],a.categories.data||(a.categories.data=r.slice(1).map((function(e){return Object(u.extractCell)(e).value})));var h=Object(u.seriesHelper)(a,n);r&&(a.categories.title=Object(u.replaceBlank)(o||Object(u.extractCell)(r[0]).value));var f=i.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));f&&!0===f.ticks&&e.length<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach((function(e,t){if(0!==t){var a=h(t-1),n=Object(u.extractCell)(e[0]),i=n.value,s=n.link;a.title=Object(u.replaceBlank)(i),a.titleLink=s;for(var r=1;r<l;r++){var o=Object(u.extractCell)(e[r]),f=o.value,d=o.link;a.data.push(Number(c(f))),a.rawData.push(f),a.links.push(d)}}}));var d=Object(u.validDataMaxLimit)(a.series,(function(e){return!isNaN(e)}));d=Math.max(d,Object(u.validDataMaxLimit)([a.categories],(function(e){return!Object(u.isBlank)(e)})))+1;var p=a.categories.data.length;if(p<d)for(var g=p;g<d;g++)i.a.isUndefined(a.categories.data[g])&&(a.categories.data[g]="");Object(u.limitSheetData)(a,d),Object(u.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"scatterSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,s=i.a.merge({},a.series[0]),r=e[0]||[],o=n.sheetnames&&n.sheetnames[t],c=this.createNumberParser(t+1),l=3===Object(u.getMaxColCount)(e);a.series=[],a.categories.data||(a.categories.data=[]);var h=Object(u.seriesHelper)(a,s),f=Object(u.categoryHelper)(a);r&&(a.categories.title=Object(u.replaceBlank)(o||r[0]),a.categories.valueLabel=Object(u.replaceBlank)(r[3],"",!0),a.axis[0].valueLabel=Object(u.replaceBlank)(r[1],"",!0),a.axis[1].valueLabel=Object(u.replaceBlank)(r[2],"",!0));var d=l?function(e,t){if(0!==t){var n=Object(u.getRowValuesAndLink)(e,u.extractCell),i=n.row,s=n.link,r=i[1],o=i[2];if(!Object(u.isBlank)(r)&&!Object(u.isBlank)(o)){var l=i[0],f=a.categories.data.length;a.categories.data.push(l);var d=h(f,t-1),p=[Number(c(r)),Number(c(o))],g=[r,o];d.data.push(p),d.rawData.push(g),d.links.push(s)}}}:function(e,t){if(0!==t){var a=Object(u.getRowValuesAndLink)(e,u.extractCell),n=a.row,i=a.link,s=n[1],r=n[2];if(!Object(u.isBlank)(s)&&!Object(u.isBlank)(r)){var o=n[4]?4:0,l=4===o?0:4,d=n[o],p=n[l],g=n[3],m=f(d),v=h(m,t-1),b=[Number(c(s)),Number(c(r))],y=[s,r];null!=g&&(y[2]=g,b[2]=Number(c(g))),null!=p&&(y[3]=p),v.data.push(b),v.rawData.push(y),v.links.push(i)}}};e.forEach(d),this.options.sheets.push(a)}},{key:"scatterSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=i.a.merge({},a.series[0]),s=Object(u.getMaxColCount)(e),r=this.options,o=e[0]&&e[0].map((function(e){return Object(u.replaceBlank)(e,"",!0)}))||[],c=Object(u.categoryHelper)(a),l=Object(u.seriesHelper)(a,n),h=o,f=e[1],d=e[2],p=e[3],g=e[4],m=i.a.get(r,"sheetnames[".concat(t,"]")),v=this.createNumberParser(t+1);a.series=[],a.categories.data||(a.categories.data=[]),a.categories.title=m||Object(u.replaceBlank)(i.a.get(o,"[0]"),"",!0),a.categories.valueLabel=Object(u.replaceBlank)(i.a.get(e,"[3][0]"),"",!0),a.axis[0].valueLabel=Object(u.replaceBlank)(i.a.get(e,"[1][0]"),"",!0),a.axis[1].valueLabel=Object(u.replaceBlank)(i.a.get(e,"[2][0]"),"",!0);for(var b=1;b<s;b++){var y=g||h,x=g?h:g,O=Object(u.extractCell)(y[b]),S=Object(u.extractCell)(x,"[".concat(b,"]")).value,k=Object(u.extractCell)(f[b]),w=Object(u.extractCell)(d[b]),C=k.value,I=w.value,j=Object(u.extractCell)(i.a.get(p,"[".concat(b,"]"))),E=j.value,T=l(c(O.value)),N=[Number(v(C)),Number(v(I))],D=[C,I],P=void 0;null!=E&&(D[2]=E,N[2]=Number(v(E))),null!=S&&(D[3]=S),[Object(u.extractCell)(h),k,w,j,Object(u.extractCell)(g)].forEach((function(e){e.link&&(P=e.link)})),T.data.push(N),T.rawData.push(D),T.links.push(P)}this.options.sheets.push(a)}},{key:"timerSheetItem",value:function(e){var t=e[0],a=!t[14]||"1"===t[14],n=this.options.sheets.push({value:new Date("".concat([t[2],t[3],t[1]].join("/")," ").concat(t.slice(4,7).join(":"))),valueString:t[0],units:t.slice(8,14),mode:t[7],categories:{title:!!a&&t[0]}});this.options.sheets[n-1].id=n.toString()}},{key:"sheetIterator",value:function(e,t){e.forEach(t,this)}},{key:"tableItem",value:function(e,t){var a=this,n=i.a.merge({},this.emptySheet),s=this.options,r=i.a.get(s,"sheetOptions[0]",{}),o=i.a.get(s,"sheetOptions[".concat(t+1,"]"),{}),c=r.hasHeaderRow,l=r.hasHeaderColumn,h=r.usePathInsteadOfText,p=i.a.get(o,"mergeCells",[]),g=i.a.get(o,"style.defaultPath")||i.a.get(r,"style.defaultPath"),m=h&&g,v=s.sheetnames&&s.sheetnames[t];n.series={data:[],shapes:f.default.shapes,sort:null};var b=0;e.forEach((function(e){b=Math.max(b,e.length)})),e.forEach((function(e,t){n.series.data[t]=[];for(var i=0;i<b;i++){var s=!t&&c||!i&&l?"igc-table-header":"igc-table-cell";n.series.data[t][i]=Object(d.default)(e[i],{assets:a.assets,className:s,pathInsteadOfText:i&&m})}})),p.forEach((function(e){var t=e.col,a=e.rowspan,s=e.colspan,r=e.row,o=n.series.data;if(i.a.has(n,"series.data[".concat(r,"][").concat(t,"]"))){if(o[r][t].colspan=s,o[r][t].rowspan=a,s>1)for(var c=1;c<s;c++)o[r][t+c]&&(o[r][t+c].remove=!0);for(var l=r+1;l<r+a;l++)for(var h=0;h<s;h++)i.a.has(o,"[".concat(l,"][").concat(t+h,"]"))&&(o[l][t+h].remove=!0)}}));var y=[];n.series.data.forEach((function(e){var t=[];e.forEach((function(e){e.remove||t.push(e)})),y.push(t)})),n.series.data=y,n.categories.title=Object(u.replaceBlank)(v)||i.a.get(y,"[0][0].value")||"Sheet "+t,c&&(n.series.headerRow=n.series.data.shift()),this.options.sheets.push(n)}},{key:"mapItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,s=n.sheetnames&&n.sheetnames[t],r=t+1,o=this.createNumberParser(r),c=/([^0-9]*)[0-9\.\ \,\']+([^0-9]*)/g,l=!!i.a.get(n,"sheetOptions[".concat(r,"].points"));a.series={data:{}},a.categories.title=Object(u.replaceBlank)(s)||"Sheet "+t;var h=i.a.get(n,"sheetOptions[".concat(r,"].xmin")),f=i.a.get(n,"sheetOptions[".concat(r,"].xmax")),d=i.a.get(n,"sheetOptions[0].xmin"),p=i.a.get(n,"sheetOptions[0].xmax"),g=[];if(void 0!==h&&void 0!==f&&""!==h&&""!==f)g=[h,f];else if(void 0!==d&&void 0!==p&&""!==p&&""!==d&&d!==p)g=[d,p];else{var m=!1;e.forEach((function(e){var t=Number(o(e[1]&&e[1].type?e[1].value:e[1]));!m&&Number.isFinite(t)?(g=[t,t],m=!0):Number.isFinite(t)&&(g[0]=Math.min(g[0],t),g[1]=Math.max(g[1],t))})),m||(g=[0,10]),g[1]===g[0]&&g[0]--,g[0]>0&&(g[0]=0)}a.limits=g;var v="",b="",y=/([\-]?[0-9]+[\.]?[0-9]*)[ \,]+([\-]?[0-9]+[\.]?[0-9]*)/;e.forEach((function(e,t){var n,s=i.a.map(e,(function(e){var t=(e=Object(u.extractCell)(e)).value;return e.link&&(n=e.link),t}));s[0]=s[0]&&s[0].toString().trim()||"",s[2]=s[2]&&s[2].toString().trim()||"";var r=s[1]?s[1].toString():"";if(0===t){c.lastIndex=0;var h=c.exec(r);h&&(v=h[1],b=h[2])}else v&&0!==r.indexOf(v)&&(v=""),b&&r.indexOf(b)!==r.length-b.length&&(b="");var f=Number(o(s[1]||0)),d=g[1]!==g[0]?(f-g[0])/(g[1]-g[0]):1;!isFinite(d)||d<0?d=0:d>1&&(d=1);var p="",m={lat:null,lng:null};if(s[3]){y.lastIndex=0;var x=y.exec(s[3]);x&&x.length>2&&(m=[parseFloat(x[1])||0,parseFloat(x[2])||0])}s.length>5&&(p=s.slice(5).join("\n"));var O=l?"".concat(s[3]).concat(s[1]):s[0];a.series.data[O]={title:s[0],value:i.a.has(s[1],"value")?s[1].value:s[1],group:i.a.has(s[2],"value")?s[2].value:s[2],coordinates:m,label:(i.a.has(s[4],"value")?s[4].value:s[4])||s[0],text:p,link:n,valueNumber:f,relativeValue:d}})),"-"===v&&(v=""),a.categories.prefix=v,a.categories.suffix=b,this.options.sheets.push(a)}}])&&g(t.prototype,a),n&&g(t,n),e}();m.IMPORT_TYPES={singleSheet:{types:[p.BAR,p.BAR_PROGRESS,p.COLUMN,p.WATERFALL,p.PIE,p.PIE_IRREGULAR,p.DOUGHNUT,p.SEMI_CIRCLE,p.BAR_RADIAL,p.PICTORIAL_SIZE,p.PICTORIAL_GRID,p.PICTORIAL_BAR,p.TREEMAP,p.WORDCLOUD,p.PYRAMID,p.FUNNEL],fn:function(e){e.length>1?this.sheetIterator(e,(function(e,t){this.singleSheetItem(e,t)})):this.singleSheetItemOnly(e[0])},fnTranspose:function(e){e.length>1?this.sheetIterator(e,(function(e,t){this.singleSheetItemTranspose(e,t)})):this.singleSheetItemOnlyTranspose(e[0])}},multiSheet:{types:[p.LINE,p.DOT_PLOT,p.AREA,p.AREA_STACKED,p.AREA_STACKED_PERCENT,p.AREA_STEPPED,p.STREAM_GRAPH,p.COLUMN_GROUPED,p.COLUMN_STACKED,p.COLUMN_STACKED_PERCENT,p.BAR_GROUPED,p.BAR_STACKED,p.BAR_STACKED_PERCENT],fn:function(e){this.sheetIterator(e,(function(e,t){this.multiSheetItem(e,t)}))},fnTranspose:function(e){this.sheetIterator(e,(function(e,t){this.multiSheetItemTranspose(e,t)}))}},bubblePlot:{types:[p.BUBBLE_PLOT],fn:function(e){this.sheetIterator(e,(function(e,t){this.multiSheetItemTranspose(e,t)}))},fnTranspose:function(e){this.sheetIterator(e,(function(e,t){this.multiSheetItem(e,t)}))}},doubleAxis:{types:[p.COLUMN_LINE,p.LINE_LINE],fn:function(e){this.sheetIterator(e,(function(e,t){this.doubleAxisSheetItem(e,t)}))},fnTranspose:function(e){this.sheetIterator(e,(function(e,t){this.doubleAxisSheetItemTranspose(e,t)}))}},combo:{types:[p.COMBO_GROUPED,p.COMBO_STACKED],fn:function(e){this.sheetIterator(e,(function(e,t){this.comboSheetItem(e,t)}))},fnTranspose:function(e){this.sheetIterator(e,(function(e,t){this.comboSheetItemTranspose(e,t)}))}},lineErrorMargin:{types:[p.LINE_ERROR_MARGIN],fn:function(e){Object(l.default)(this).default(e)},fnTranspose:function(e){Object(l.default)(this).transposed(e)}},timer:{types:[p.TIMER],fn:function(e){this.sheetIterator(e,this.timerSheetItem)}},scatter:{types:[p.SCATTER,p.SCATTER_GROUPED,p.BUBBLE],fn:function(e){this.sheetIterator(e,(function(e,t){this.scatterSheetItem(e,t)}))},fnTranspose:function(e){this.sheetIterator(e,(function(e,t){this.scatterSheetItemTranspose(e,t)}))}},gantt:{types:[p.GANTT],fn:function(e){Object(o.default)(this).default(e)},fnTranspose:function(e){Object(o.default)(this).transposed(e)}},map:{types:[p.MAP],fn:function(e){this.sheetIterator(e,(function(e,t){this.mapItem(e,t)}))}},table:{types:[p.TABLE],fn:function(e){this.sheetIterator(e,(function(e,t){this.tableItem(e,t)}))}},FactsAndFigures:{types:[p.FACTS_AND_FIGURES],fn:function(e){var t=this;this.sheetIterator(e,(function(e,a){t.FactsAndFiguresItem(e,a)}))}},gauge:{types:[p.GAUGE],fn:function(e){Object(r.default)(e,this)}},candle:{types:[p.CANDLESTICK],fn:function(e){Object(c.default)(this).default(e)},fnTranspose:function(e){Object(c.default)(this).transposed(e)}},BarRace:{types:[p.BAR_RACE],fn:function(e){Object(h.default)(this).default(e)},fnTranspose:function(e){Object(h.default)(this).transposed(e)}}},t.default={create:function(e){return new m(e)},NumberParser:s.default}},m6Yx:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),s=a("Z8Pq");t.default=function(e,t){var a=t.emptySheet,n=t.createNumberParser,r=t.options,o=t.useAllColumns,c=r.sheets;function l(e,r){var o=n.call(t,r+1),l=function(e,t){return e=o(e),isNaN(e)?t:e},h=i.a.merge({},a),u=h.series[0],f=h.categories.data=[];h.categories.title=Object(s.replaceBlank)(e[0][1],"");var d=Object(s.replaceBlank)(e[1][1],0,!0),p=l(d,0),g=Object(s.replaceBlank)(e[2][1],100,!0),m=l(g,100),v=e[3][1],b=v&&"link"===v.type,y=Object(s.replaceBlank)(b?v.value:v,50),x=l(y,50),O=Object(s.replaceBlank)(e[4][1],"",!0);f.push(O);var S={min:{label:d.toString(),value:p},max:{label:g.toString(),value:m},value:x};b&&(S.link=v.href),u.index=r,u.data.push(S),u.rawData.push(i.a.merge({},S,{value:y})),c.push(h)}e=Object(s.fillSheets)(e,5,2),e=Object(s.spreadSheets)(e,o),void 0===t.sheetIndex?e.forEach((function(e,t){l.call(this,e,t)}),this):l.call(this,e[t.sheetIndex],t.sheetIndex)}},pLmG:function(e,t,a){"use strict";a.r(t),function(e,n){var i=a("XzT5"),s=a("Du7+"),r=function(e){return parseInt(e.ord,10)};var o=function(e,t,a){var n=e.position()[a]-t.position()[a];return n=(n>0?"+=":"-=")+Math.abs(n)+"px"};t.default={recalculateMargin:function(){var t=s.default.getMargin(),a=!1;e(".moveable_w, .undo_w").each((function(){var n=e(this).hasClass("shrink"),i=0;a&&n&&(i=t-1),i<0&&(i=0),e(this).css("margin-left",i),a=n&&!a}))},removeMargin:function(t){e(t).css("margin-left","")},setPlaceholders:function(){var t,a,n,r,c,l=e(".ig-items").width(),h=[];return e(".sbs_placeholder").remove(),e(".moveable_w.shrink").each((function(){var u=e(this).width();t=!!e(this).next(".moveable_w.shrink, .undo_w.shrink").length,n=e(this).position().left+u,a=l-n,!t&&a>u&&((r=e('<div class="sbs_placeholder">')).html('<div class="sbs_placeholder_message">'),r.find(".sbs_placeholder_message").html('<p class="center_vh">'+i.default.t("app.edit.drag_here")+"</p>"),c=e(this).children(".moveable"),r.css("width",c.width()),r.height(c.height()),e(this).after(r),h.push(r.get(0)),r.on("drop",(function(t){var a=t.originalEvent.dataTransfer.getData("text");if(a){var n,r=e('[data-object-id="'+a+'"]'),c=e(this),l=c.prev(),h=parseInt(r.attr("ord"),10),u=parseInt(l.attr("ord"),10),f=u+1,d=r.find(".icon-min-object");if(h<u&&(f=u),!r.is(l)){if(n=r.clone(),c.remove(),!r.hasClass("shrink")){if(n.find(".moveable").hasClass("chart")){var p=e(this).width()-s.default.getMargin();n.find(".inner").width(p)}d.trigger("click"),ga("send","event","edit","side_by_side","drag_and_drop",0),ga("App.send","event","edit","side_by_side","drag_and_drop",0)}e.ajax({url:"/api/itemorder/".concat(graphicID),headers:{"csrf-token":window.app.profile.csrfToken},data:{newpos:f,count:e(".moveable_w").length,type:r.attr("data-object-type"),object_id:r.attr("data-object-id")},type:"PUT",beforeSend:function(){window.app.events.trigger("Editable:saving")}}).done((function(){n.find(".moveable").css({"margin-left":"20px"}),n.css({position:"absolute",width:r.css("width"),"z-index":10,"margin-left":0,"margin-right":0,top:r.position().top+"px",left:r.position().left+"px"}).insertBefore(r),r.css("opacity",0),r.insertAfter(l);var t=o(r,n,"top"),a=o(r,n,"left");n.animate({top:t,left:a},{complete:function(){e(".item-insertion").remove(),n.remove(),r.css("opacity",1),window.app.events.trigger("Editable:resetOrder Editable:shrink")}})})).fail((function(){window.app.message.error(i.default.t("app.errors.order_state"))})).always((function(){window.app.events.trigger("Editable:saved")}))}}})))})),h},lastInRowElements:function(){var t=[],a=[];e(".moveable_w.shrink").each((function(){a.push({id:e(this).attr("data-object-id"),top:e(this).position().top,ord:e(this).attr("ord")})}));var i=n.groupBy(a,(function(e){return e.top}));for(var s in i)t.push(n.maxBy(i[s],r));return t},chartWidth:function(t){var a=e(".ig-items").width();return parseInt((a-2*s.default.getChartPadding()-s.default.getMargin())/t,10)},boxWidth:function(t,a){var n=e(".ig-items").width(),i=parseInt((n-s.default.getMargin())/2,10);a.css({width:i+"px"})}}}.call(this,a("+hRF"),a("LvDl"))},tcv8:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n);function s(e,t){if(i.a.isEqual(t,[]))return t}t.default=function(e){var t=e.chart,a=e.sheetIndex,n=void 0===a,r=t.get("sheets_settings"),o=r[a];function c(){return t.get("colors")}return{get isCommon(){return n},getColors:function(){return n?c():o&&i.a.has(o,"colors")&&o.colors&&o.colors.length?o.colors:c()},getCustomValue:function(e,a){var s=this.getCustom();return i.a.has(s,e)?i.a.get(s,e):!n&&(s=t.get("custom"),i.a.has(s,e))?i.a.get(s,e):a},getCustom:function(){return o||t.get("custom")},getLocalisations:function(){return i.a.get(t.get("custom"),"map_json.localisations")},getCustomStrict:function(){return n?t.get("custom"):o||{}},setCustom:function(e){if(n){var c=t.get("custom");i.a.mergeWith(c,e,s)}else o||(o=r[a]={}),i.a.mergeWith(o,e,s),t.set("sheets_settings",r,{silent:!0})},removeCustom:function(e){if(n){var s=t.get("custom");e.forEach((function(e){i.a.unset(s,e)}))}else o||(o=r[a]={}),e.forEach((function(e){i.a.unset(o,e)})),t.set("sheets_settings",r,{silent:!0})}}}},wUcv:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"buildXHR",(function(){return r}));var n=a("LvDl"),i=a.n(n),s=a("bZl7");function r(t){var a,n=t.chart,r=t.sheetIndex,o=t.applyToAllSheets,c={infographic:n.get("block_id"),applyToAllSheets:o};return void 0!==r?(c.sheet_settings_index=r,a=c.sheet_settings={}):a=c.custom={},{searchOsm:function(t){return e.ajax({url:encodeURI("https://nominatim.openstreetmap.org/search/?format=json&accept-language=en-GB,en-US&limit=1&bounded=1&q=".concat(t)),type:"GET",format:"json"})},send:function(){return i.a.has(c,"custom.groupedColors")&&(c.custom.groupedColors=i.a.toPairs(c.custom.groupedColors)),n.get("isFreelayoutInline")?e.Deferred().resolve():e.ajax({url:"/api/charts/"+n.get("object_id"),type:"PUT",data:JSON.stringify(c),contentType:"application/json; charset=utf-8",headers:{"csrf-token":s.default.profile.csrfToken}})},setCustom:function(e){return i.a.merge(a,e),this},setParams:function(e){return i.a.merge(c,e),this}}}}.call(this,a("+hRF"))},wrGL:function(e,t,a){"use strict";a.r(t),a.d(t,"defaultColorValue",(function(){return r})),a.d(t,"defaultColorMethod",(function(){return o})),a.d(t,"gridColor",(function(){return c}));var n=a("LvDl"),i=a.n(n),s=a("pWQL");function r(e,t){var a={method:"contrast",contrast:{dark:e||"#000000",light:"#ffffff"},manual:{fill:"#000000",stroke:"#ffffff"}};return"manual"===t&&(i.a.set(a,"method",t),i.a.set(a,"contrast.dark","#000000"),i.a.set(a,"manual.fill",e||"#000000")),a}function o(e){return-1!==[s.WATERFALL,s.GANTT].indexOf(e.getTypeMod())?"manual":"contrast"}function c(e,t){return i.a.get(e,"axis.color")||i.a.get(t,"charts.grid.color")||i.a.get(e,"textColor")||i.a.get(t,"color.chart.text")||i.a.get(t,"color.text")}}}]);